
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery_output\plot_geographic_finite_difference.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_output_plot_geographic_finite_difference.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_output_plot_geographic_finite_difference.py:


Geographic Finite Difference
===================================

Before proceeding with all the steps, first import some necessary libraries and packages

.. GENERATED FROM PYTHON SOURCE LINES 8-13

.. code-block:: default

    import easyclimate as ecl
    import xarray as xr
    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs








.. GENERATED FROM PYTHON SOURCE LINES 14-15

Then consider obtaining meridional and zonal wind variables in tutorial data

.. GENERATED FROM PYTHON SOURCE LINES 15-28

.. code-block:: default


    u_data = ecl.tutorial.open_tutorial_dataset('uwnd_202201_mon_mean').sortby('lat').uwnd
    v_data = ecl.tutorial.open_tutorial_dataset('vwnd_202201_mon_mean').sortby('lat').vwnd
    z_data = ecl.tutorial.open_tutorial_dataset('hgt_202201_mon_mean').sortby('lat').hgt
    temp_data = ecl.tutorial.open_tutorial_dataset('air_202201_mon_mean').sortby('lat').air
    q_data = ecl.tutorial.open_tutorial_dataset('shum_202201_mon_mean').sortby('lat').shum
    msl_data = ecl.tutorial.open_tutorial_dataset('pressfc_202201_mon_mean').sortby('lat').pres
    pr_data = ecl.tutorial.open_tutorial_dataset('precip_202201_mon_mean').sortby('lat').precip

    uvdata = xr.Dataset()
    uvdata['uwnd'] = u_data
    uvdata['vwnd'] = v_data








.. GENERATED FROM PYTHON SOURCE LINES 29-30

Obtain data slices on 500hPa isobars for January 2022

.. GENERATED FROM PYTHON SOURCE LINES 30-35

.. code-block:: default


    uvdata_500_202201 = uvdata.sel(level = 500, time = '2022-01-01')
    z_data_500_202201 = z_data.sel(level = 500, time = '2022-01-01')
    temp_data_500_202201 = temp_data.sel(level = 500, time = '2022-01-01')








.. GENERATED FROM PYTHON SOURCE LINES 36-37

Plotting a sample `quiver` plot of this data slice

.. GENERATED FROM PYTHON SOURCE LINES 37-51

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.stock_img()
    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uvdata_500_202201.thin(lon = 3, lat = 3).plot.quiver(
        ax = ax,
        u = 'uwnd', v = 'vwnd', x = 'lon', y = 'lat',
        # projection on data
        transform = ccrs.PlateCarree(),
    )




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_001.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.quiver.Quiver object at 0x000001E4B1DCE4D0>



.. GENERATED FROM PYTHON SOURCE LINES 52-62

First-order Partial Derivative
-------------------------------------

Consider the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to compute the gradient of the zonal wind with respect to longitude.

.. math::

  \frac{\partial u}{\partial \lambda}

The argument `dim` to the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` specifies that the direction of the solution is `longitude`.

.. GENERATED FROM PYTHON SOURCE LINES 62-70

.. code-block:: default


    uwnd_dx = ecl.calc_gradient(
        uvdata_500_202201.uwnd, 
        dim = 'lon'
    )

    uwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;uwnd&#x27; (lat: 73, lon: 144)&gt;
    array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)
    Coordinates:
        time     datetime64[ns] 2022-01-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
        level    float32 500.0
    Attributes:
        long_name:     Monthly mean u wind
        units:         m/s
        precision:     2
        var_desc:      u-wind
        level_desc:    Pressure Levels
        statistic:     Mean
        parent_stat:   Other
        dataset:       NCEP Reanalysis Derived Products
        actual_range:  [-68.194824 124.399994]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'uwnd'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6ba79ee8-21cb-4f71-8eee-d911ba28cbaa' class='xr-array-in' type='checkbox' checked><label for='section-6ba79ee8-21cb-4f71-8eee-d911ba28cbaa' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.15 0.1323 0.1185 0.1125 ... -0.08952 -0.0754 -0.06532 -0.06694</span></div><div class='xr-array-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-57fae94a-3328-4adc-b4e8-318bea87780a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-57fae94a-3328-4adc-b4e8-318bea87780a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-a77868d3-3982-4b23-980b-43dbd38f48a4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a77868d3-3982-4b23-980b-43dbd38f48a4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-196d7254-d402-4f38-a9b1-c4ab18b57206' class='xr-var-data-in' type='checkbox'><label for='data-196d7254-d402-4f38-a9b1-c4ab18b57206' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-bf5ab2f8-be86-49e5-9836-33d58fe04622' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf5ab2f8-be86-49e5-9836-33d58fe04622' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-997c31e2-dbe4-4d6c-a95f-2e89c686d737' class='xr-var-data-in' type='checkbox'><label for='data-997c31e2-dbe4-4d6c-a95f-2e89c686d737' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-61121e8a-6a16-44f9-bcab-36636649ac9f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61121e8a-6a16-44f9-bcab-36636649ac9f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a3c377c-b05c-460b-a76c-1c5601fcd069' class='xr-var-data-in' type='checkbox'><label for='data-1a3c377c-b05c-460b-a76c-1c5601fcd069' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-33f9216b-4646-46fb-a2f9-b5a6da8464fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33f9216b-4646-46fb-a2f9-b5a6da8464fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0aa38d1-c3a2-457b-857a-923bc1eaa3e1' class='xr-var-data-in' type='checkbox'><label for='data-e0aa38d1-c3a2-457b-857a-923bc1eaa3e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f444bef5-67c2-404c-9f13-0f4f67eb9b4e' class='xr-section-summary-in' type='checkbox'  ><label for='section-f444bef5-67c2-404c-9f13-0f4f67eb9b4e' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6cf3afc8-7a1c-49bb-9035-24492d70eddf' class='xr-index-data-in' type='checkbox'/><label for='index-6cf3afc8-7a1c-49bb-9035-24492d70eddf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-07386207-d5f7-443f-903e-d00a89a68a89' class='xr-index-data-in' type='checkbox'/><label for='index-07386207-d5f7-443f-903e-d00a89a68a89' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-44d0f83c-d822-428b-a783-210cfb5f5242' class='xr-section-summary-in' type='checkbox'  checked><label for='section-44d0f83c-d822-428b-a783-210cfb5f5242' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 71-87

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.stock_img()
    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dx.plot.contourf(
        ax = ax,
        # projection on data
        transform = ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs = {'location': 'bottom'},
        levels = 21,
    )




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_002.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000001E4B1627D30>



.. GENERATED FROM PYTHON SOURCE LINES 88-89

Of course, it is also possible to pass in :py:class:`xarray.Dataset<xarray.Dataset>` directly into the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to iterate through all the variables, so that you can get the gradient of both the zonal and meridional winds with respect to longitude at the same time.

.. GENERATED FROM PYTHON SOURCE LINES 89-97

.. code-block:: default


    uvwnd_dx = ecl.calc_gradient(
        uvdata_500_202201, 
        dim = 'lon'
    )

    uvwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (lon: 144, lat: 73)
    Coordinates:
        time     datetime64[ns] 2022-01-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
        level    float32 500.0
    Data variables:
        uwnd     (lat, lon) float32 0.15 0.1323 0.1185 ... -0.0754 -0.06532 -0.06694
        vwnd     (lat, lon) float32 0.1734 0.1815 0.1895 ... 0.2218 0.2234 0.2137</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6fa175ad-308b-477b-a2f2-a874a058df4c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6fa175ad-308b-477b-a2f2-a874a058df4c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-49eb3520-1723-43f1-b300-db3f49d50534' class='xr-section-summary-in' type='checkbox'  checked><label for='section-49eb3520-1723-43f1-b300-db3f49d50534' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-37ed6eab-4e0f-4015-bcdf-28b1b0bf9ac4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37ed6eab-4e0f-4015-bcdf-28b1b0bf9ac4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d52c50b3-4e8a-4db9-90a0-c133f64c3238' class='xr-var-data-in' type='checkbox'><label for='data-d52c50b3-4e8a-4db9-90a0-c133f64c3238' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-e88692dd-8df0-4eb4-b0f0-21e940a62955' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e88692dd-8df0-4eb4-b0f0-21e940a62955' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b2ea2c6-029f-4e7e-92f8-6b919477f354' class='xr-var-data-in' type='checkbox'><label for='data-0b2ea2c6-029f-4e7e-92f8-6b919477f354' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-c8c646ec-b3e3-4f36-8646-935d72037a29' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8c646ec-b3e3-4f36-8646-935d72037a29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6540a68-1dff-4628-a8d8-a1a0da1b9e9a' class='xr-var-data-in' type='checkbox'><label for='data-c6540a68-1dff-4628-a8d8-a1a0da1b9e9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-2e14479b-8db2-4d13-b006-d02b8ba18421' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e14479b-8db2-4d13-b006-d02b8ba18421' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ea93196-d68a-4fce-8ff2-f13d38c96516' class='xr-var-data-in' type='checkbox'><label for='data-3ea93196-d68a-4fce-8ff2-f13d38c96516' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fed61183-ff18-465d-b0eb-9b86297b750d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fed61183-ff18-465d-b0eb-9b86297b750d' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.15 0.1323 ... -0.06532 -0.06694</div><input id='attrs-a71b626b-f227-4ce1-a418-c60aafe3d8eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a71b626b-f227-4ce1-a418-c60aafe3d8eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f27c2e75-1e70-45f2-a76e-40dc0ccf9803' class='xr-var-data-in' type='checkbox'><label for='data-f27c2e75-1e70-45f2-a76e-40dc0ccf9803' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1734 0.1815 ... 0.2234 0.2137</div><input id='attrs-60fbab1b-3401-4408-a7eb-fe3c5a962e49' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60fbab1b-3401-4408-a7eb-fe3c5a962e49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63c22f9b-3db1-4d4d-a593-495178f5f190' class='xr-var-data-in' type='checkbox'><label for='data-63c22f9b-3db1-4d4d-a593-495178f5f190' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean v wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>v-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.57001  68.56999]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.17338598,  0.1814518 ,  0.18951654, ...,  0.15846789,
             0.1677419 ,  0.17258167],
           [ 0.1516118 ,  0.16128993,  0.18346763, ...,  0.08145142,
             0.09516072,  0.10322666],
           [ 0.1903243 ,  0.24516177,  0.28387117, ...,  0.06572509,
             0.11209702,  0.16209793],
           ...,
           [-0.02338713, -0.00887108,  0.00120991, ..., -0.0399195 ,
            -0.03588688, -0.02540255],
           [ 0.10685444,  0.11249995,  0.11653227, ...,  0.09112895,
             0.09274191,  0.10564566],
           [ 0.22661296,  0.22983876,  0.2318549 , ...,  0.2217744 ,
             0.22338712,  0.21370983]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f7d8fb39-65f6-43f4-bbe1-3eb92ad8b3dc' class='xr-section-summary-in' type='checkbox'  ><label for='section-f7d8fb39-65f6-43f4-bbe1-3eb92ad8b3dc' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1c3118ce-457d-4fa7-8de0-9fc82736e56b' class='xr-index-data-in' type='checkbox'/><label for='index-1c3118ce-457d-4fa7-8de0-9fc82736e56b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-76aa797f-d5b0-468e-9084-c97438029f32' class='xr-index-data-in' type='checkbox'/><label for='index-76aa797f-d5b0-468e-9084-c97438029f32' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af4e54e2-2124-4684-b464-f7e3dab38181' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-af4e54e2-2124-4684-b464-f7e3dab38181' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 98-102

However, if one is required to solve for the gradient of the zonal wind with respect to the corresponding distance at each longitude, the function `calc_lon_gradient` should be used to calculate.

.. math::
  \frac{\partial F}{\partial x} = \frac{1}{R \cos\varphi} \cdot \frac{\partial F}{\partial \lambda}

.. GENERATED FROM PYTHON SOURCE LINES 102-119

.. code-block:: default


    uwnd_dlon = ecl.calc_lon_gradient(uvdata_500_202201.uwnd, lon_dim = 'lon', lat_dim = 'lat')

    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlon.plot.contourf(
        ax = ax,
        # projection on data
        transform = ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs = {'location': 'bottom'},
        levels = 21,
    )




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_003.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000001E4B1D8BE80>



.. GENERATED FROM PYTHON SOURCE LINES 120-121

Similarly, use :py:func:`easyclimate.calc_lat_gradient <easyclimate.calc_lat_gradient>` to solve for the gradient of the meridional wind with respect to the corresponding distance at each latitude.

.. GENERATED FROM PYTHON SOURCE LINES 123-132

Second-order Partial Derivative
------------------------------------

The solution of the second-order partial derivative relies on three functional calculations

- :py:func:`easyclimate.calc_lon_laplacian <easyclimate.calc_lon_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along longitude.

.. math::
  \frac{\partial^2 F}{\partial x^2} = \frac{1}{(R \cos\varphi)^2} \cdot \frac{\partial^2 F}{\partial \lambda^2}

.. GENERATED FROM PYTHON SOURCE LINES 132-139

.. code-block:: default


    uwnd_dlon2 = ecl.calc_lon_laplacian(
        uvdata_500_202201.uwnd, 
        lon_dim = 'lon', 
        lat_dim = 'lat'
    )








.. GENERATED FROM PYTHON SOURCE LINES 140-144

- :py:func:`easyclimate.calc_lat_laplacian <easyclimate.calc_lat_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along latitude.

.. math::
  \frac{\partial^2 F}{\partial y^2} = \frac{1}{R^2} \cdot \frac{\partial^2 F}{\partial \varphi^2}

.. GENERATED FROM PYTHON SOURCE LINES 145-151

.. code-block:: default


    uwnd_dlat2 = ecl.calc_lat_laplacian(
        uvdata_500_202201.uwnd, 
        lat_dim = 'lat'
    )








.. GENERATED FROM PYTHON SOURCE LINES 152-157

- :py:func:`easyclimate.calc_lon_lat_mixed_derivatives <easyclimate.calc_lon_lat_mixed_derivatives>`: second-order mixed partial derivative terms along longitude and latitude.

.. math::
  \frac{\partial^2 F}{\partial x \partial y} = \frac{1}{R^2 \cos\varphi} \cdot \frac{\partial^2 F}{\partial \lambda \partial \varphi}


.. GENERATED FROM PYTHON SOURCE LINES 158-165

.. code-block:: default


    uwnd_dlonlat = ecl.calc_lon_lat_mixed_derivatives(
        uvdata_500_202201.uwnd, 
        lon_dim = 'lon', 
        lat_dim = 'lat'
    )








.. GENERATED FROM PYTHON SOURCE LINES 166-167

Second-order partial derivative term along longitude.

.. GENERATED FROM PYTHON SOURCE LINES 167-176

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlon2.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial x^2}$', fontsize = 20)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_004.png
   :alt: $\frac{\partial^2 F}{\partial x^2}$
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0326797365031362, '$\\frac{\\partial^2 F}{\\partial x^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 177-178

Second-order partial derivative term along latitude.

.. GENERATED FROM PYTHON SOURCE LINES 178-187

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlat2.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial y^2}$', fontsize = 20)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_005.png
   :alt: $\frac{\partial^2 F}{\partial y^2}$
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0480710965501792, '$\\frac{\\partial^2 F}{\\partial y^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 188-189

Second-order mixed partial derivative terms along longitude and latitude.

.. GENERATED FROM PYTHON SOURCE LINES 189-198

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlonlat.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial x \\partial y}$', fontsize = 20)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_006.png
   :alt: $\frac{\partial^2 F}{\partial x \partial y}$
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0287305387544805, '$\\frac{\\partial^2 F}{\\partial x \\partial y}$')



.. GENERATED FROM PYTHON SOURCE LINES 199-209

Vorticity and Divergence
------------------------------------

Vorticity and divergence are measures of the degree of atmospheric rotation and volumetric flux per unit volume respectively. For vorticity and divergence in the quasi-geostrophic case, the potential height is used as input data for the calculations. In general, we first calculate the quasi-geostrophic wind.

- :py:func:`easyclimate.calc_geostrophic_wind <easyclimate.calc_geostrophic_wind>`: calculate the geostrophic wind. 

.. math::
  u_g = - \frac{g}{f} \frac{\partial H}{\partial y}, \ v_g = \frac{g}{f} \frac{\partial H}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 209-216

.. code-block:: default


    geostrophic_wind_data_500_202201 = ecl.calc_geostrophic_wind(
        z_data_500_202201, 
        lon_dim = 'lon', 
        lat_dim = 'lat'
    )








.. GENERATED FROM PYTHON SOURCE LINES 217-224

The function :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>` is then used to compute the quasi-geostrophic vorticity.

- :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>`: calculate the horizontal relative vorticity term.

.. math::
  \zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} + \frac{u}{R} \tan \varphi


.. GENERATED FROM PYTHON SOURCE LINES 224-233

.. code-block:: default


    qg_vor_data_500_202201 = ecl.calc_vorticity(
        u_data = geostrophic_wind_data_500_202201.ug, 
        v_data = geostrophic_wind_data_500_202201.vg,
        lon_dim = 'lon', lat_dim = 'lat',
    )

    qg_vor_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_007.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B3D8A860>



.. GENERATED FROM PYTHON SOURCE LINES 234-235

Similar vorticity for actual winds, but for actual winds rather than quasi-geostrophic winds.

.. GENERATED FROM PYTHON SOURCE LINES 235-244

.. code-block:: default


    vor_data_500_202201 = ecl.calc_vorticity(
        u_data = uvdata_500_202201['uwnd'], 
        v_data = uvdata_500_202201['vwnd'],
        lon_dim = 'lon', lat_dim = 'lat',
    )

    vor_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_008.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B1B0BCA0>



.. GENERATED FROM PYTHON SOURCE LINES 245-253

In addition, the function :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>` calculate the quasi-geostrophic divergence.

.. math::
  \mathrm{D} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} - \frac{v}{R} \tan \varphi

- :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>`: calculate the horizontal divergence term.

Quasi-geostrophic divergence

.. GENERATED FROM PYTHON SOURCE LINES 253-262

.. code-block:: default


    qg_div_data_500_202201 = ecl.calc_divergence(
        u_data = geostrophic_wind_data_500_202201.ug,
        v_data = geostrophic_wind_data_500_202201.vg,
        lon_dim = 'lon', lat_dim = 'lat',
    )

    qg_div_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_009.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B30D6110>



.. GENERATED FROM PYTHON SOURCE LINES 263-264

Actual divergence

.. GENERATED FROM PYTHON SOURCE LINES 264-273

.. code-block:: default


    div_data_500_202201 = ecl.calc_divergence(
        u_data = uvdata_500_202201['uwnd'], 
        v_data = uvdata_500_202201['vwnd'],
        lon_dim = 'lon', lat_dim = 'lat',
    )

    div_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_010.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B3EFE860>



.. GENERATED FROM PYTHON SOURCE LINES 274-278

Of course, in addition to the built-in finite difference method, the spherical harmonic function mothod can be solved, but you must ensure that it is **Global** and **Regular or Gaussian grid** type data.

- :py:func:`easyclimate.windspharm.calc_relative_vorticity <easyclimate.windspharm.top.calc_relative_vorticity>`: calculate the relative vorticity term with the spherical harmonic function mothod.
- :py:func:`easyclimate.windspharm.calc_divergence <easyclimate.windspharm.top.calc_divergence>`: calculate the horizontal divergence term with the spherical harmonic function mothod.

.. GENERATED FROM PYTHON SOURCE LINES 278-286

.. code-block:: default


    vor_data_500_202201_windspharm = ecl.windspharm.calc_relative_vorticity(
        u_data = uvdata_500_202201['uwnd'],
        v_data = uvdata_500_202201['vwnd'],
    )

    vor_data_500_202201_windspharm.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_011.png
   :alt: plot geographic finite difference
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_011.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B4150700>



.. GENERATED FROM PYTHON SOURCE LINES 287-295

.. code-block:: default


    div_data_500_202201_windspharm = ecl.windspharm.calc_divergence(
        u_data = uvdata_500_202201['uwnd'],
        v_data = uvdata_500_202201['vwnd'],
    )

    div_data_500_202201_windspharm.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_012.png
   :alt: plot geographic finite difference
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B637DED0>



.. GENERATED FROM PYTHON SOURCE LINES 296-297

Generally speaking, the calculation results of the finite difference method and the spherical harmonic function method are similar. The former does not require global regional data, but the calculation results of the latter are more accurate for high latitude regions.

.. GENERATED FROM PYTHON SOURCE LINES 299-308

Advection
-------------------
`Advection <https://glossary.ametsoc.org/wiki/Advection>`__ is the process of transport of an atmospheric property solely by the mass motion (velocity field) of the atmosphere; also, the rate of change of the value of the advected property at a given point.

For zonal advection, we can calculate as follows.

.. math::
  -u \frac{\partial T}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 308-316

.. code-block:: default


    u_advection_500_202201 = ecl.calc_u_advection(
        u_data = uvdata_500_202201['uwnd'],
        temper_data = temp_data_500_202201
    )

    u_advection_500_202201.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_013.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_013.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B8897BB0>



.. GENERATED FROM PYTHON SOURCE LINES 317-322

Similarly, the meridional advection can acquire as follows.

.. math::
  -v \frac{\partial T}{\partial y}


.. GENERATED FROM PYTHON SOURCE LINES 322-330

.. code-block:: default


    v_advection_500_202201 = ecl.calc_v_advection(
        v_data = uvdata_500_202201['vwnd'],
        temper_data = temp_data_500_202201
    )

    v_advection_500_202201.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_014.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_014.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000001E4B8AF04C0>



.. GENERATED FROM PYTHON SOURCE LINES 331-347

Water Flux
-------------------------

- :py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>`: calculate horizontal water vapor flux at each vertical level.

.. math::
  \frac{1}{g} q \mathbf{V} = \frac{1}{g} (u q\ \mathbf{i} + vq\ \mathbf{j})

- :py:func:`easyclimate.calc_vertical_water_flux <easyclimate.calc_vertical_water_flux>`: calculate vertical water vapor flux.

.. math::
  -\omega \frac{q}{g}

- :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>`: calculate the water vapor flux across the vertical level.

:py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>` can calculate the horizontal water flux of single layers.

.. GENERATED FROM PYTHON SOURCE LINES 347-354

.. code-block:: default


    ecl.calc_horizontal_water_flux(
        specific_humidity_data = q_data, 
        u_data = uvdata.uwnd,
        v_data = uvdata.vwnd,
    )






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (time: 2, lon: 144, lat: 73, level: 8)
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
      * level    (level) float32 1e+03 925.0 850.0 700.0 600.0 500.0 400.0 300.0
    Data variables:
        qu       (time, level, lat, lon) float32 0.3579 0.3982 ... -0.007047
        qv       (time, level, lat, lon) float32 -0.9287 -0.9122 ... 0.001194</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d9c76ee2-c316-406c-92d0-f23cb9eb59aa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d9c76ee2-c316-406c-92d0-f23cb9eb59aa' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>level</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4df4955e-8413-496b-93ce-48c3099531bf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4df4955e-8413-496b-93ce-48c3099531bf' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-177b9365-c50b-4334-9dbd-9faf4d29a1be' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-177b9365-c50b-4334-9dbd-9faf4d29a1be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06334a27-321c-4693-8bc3-7dc062542fcb' class='xr-var-data-in' type='checkbox'><label for='data-06334a27-321c-4693-8bc3-7dc062542fcb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-0c011136-e9da-491d-ac96-209fdcc13368' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c011136-e9da-491d-ac96-209fdcc13368' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ebb3e926-a43e-450c-9af6-07ab8639f94c' class='xr-var-data-in' type='checkbox'><label for='data-ebb3e926-a43e-450c-9af6-07ab8639f94c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-25fa7232-41ae-4616-b1f5-daa0ace7c2af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-25fa7232-41ae-4616-b1f5-daa0ace7c2af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8812473-6607-484a-b5a9-0469e9076d3b' class='xr-var-data-in' type='checkbox'><label for='data-e8812473-6607-484a-b5a9-0469e9076d3b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 400.0 300.0</div><input id='attrs-306ec7c9-ba4a-4e33-bf74-4898071455b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-306ec7c9-ba4a-4e33-bf74-4898071455b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c9c3e14-922c-4e7a-bd7f-d8a49aa24cb0' class='xr-var-data-in' type='checkbox'><label for='data-9c9c3e14-922c-4e7a-bd7f-d8a49aa24cb0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.  300.]</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0a970432-e450-4d98-af45-cd2baaf8a3df' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0a970432-e450-4d98-af45-cd2baaf8a3df' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.3579 0.3982 ... -0.007047</div><input id='attrs-f3100565-8496-4f13-9689-a34aa4200bb8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3100565-8496-4f13-9689-a34aa4200bb8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2fae597-40ac-4472-895d-83a11e8485c5' class='xr-var-data-in' type='checkbox'><label for='data-e2fae597-40ac-4472-895d-83a11e8485c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 3.57883036e-01,  3.98152560e-01,  4.38422114e-01, ...,
               2.34596267e-01,  2.76930898e-01,  3.16993952e-01],
             [ 6.72771037e-02,  1.20953225e-01,  1.75328195e-01, ...,
              -8.64081681e-02, -3.64194512e-02,  1.26979304e-02],
             [ 4.37529944e-02,  1.26659304e-01,  2.18098059e-01, ...,
              -1.39770165e-01, -8.91409293e-02, -2.89416406e-02],
             ...,
             [-1.29531682e-01, -1.49078846e-01, -1.68693021e-01, ...,
              -7.36974776e-02, -9.17841047e-02, -1.10312007e-01],
             [-1.70557305e-01, -1.75420001e-01, -1.79937020e-01, ...,
              -1.53795123e-01, -1.59868911e-01, -1.65068328e-01],
             [-2.19000965e-01, -2.25325063e-01, -2.31118590e-01, ...,
              -1.97861537e-01, -2.05247089e-01, -2.12588385e-01]],

            [[ 2.69623637e-01,  3.00784588e-01,  3.31781358e-01, ...,
               1.71712905e-01,  2.03857839e-01,  2.37314716e-01],
             [ 5.87694049e-02,  1.02082960e-01,  1.47941858e-01, ...,
              -6.27753958e-02, -2.28826758e-02,  1.66655779e-02],
             [ 1.21284816e-02,  7.87778050e-02,  1.51972592e-01, ...,
              -1.33276269e-01, -9.41526294e-02, -4.61209677e-02],
    ...
              -8.08279868e-03, -8.66123475e-03, -9.28526092e-03],
             [-2.21411902e-02, -2.19771210e-02, -2.17400584e-02, ...,
              -2.27421131e-02, -2.25342512e-02, -2.23478209e-02],
             [-3.46937589e-02, -3.42834592e-02, -3.38446163e-02, ...,
              -3.54394391e-02, -3.52539122e-02, -3.50005962e-02]],

            [[ 4.03247541e-03,  4.02526790e-03,  4.00544750e-03, ...,
               4.04148409e-03,  4.05770075e-03,  4.04508831e-03],
             [ 6.15896285e-03,  6.34491444e-03,  6.51857676e-03, ...,
               5.91550255e-03,  5.91961620e-03,  6.04589144e-03],
             [ 6.69910340e-03,  7.49462703e-03,  8.37483816e-03, ...,
               5.19840326e-03,  5.43986401e-03,  5.99670364e-03],
             ...,
             [-1.21538877e-03, -1.24731637e-03, -1.27466582e-03, ...,
              -1.13206636e-03, -1.16068567e-03, -1.18242716e-03],
             [-3.84470983e-03, -3.76838353e-03, -3.65987723e-03, ...,
              -4.09236364e-03, -4.01350297e-03, -3.94624844e-03],
             [-6.99382089e-03, -6.91809133e-03, -6.83114212e-03, ...,
              -7.12775113e-03, -7.09689967e-03, -7.04711350e-03]]]],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.9287 -0.9122 ... 0.001194</div><input id='attrs-26916347-aaec-41f2-a661-e036de9ae7db' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-26916347-aaec-41f2-a661-e036de9ae7db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9004ad56-4cc0-4cca-b7c2-3384eb8c1aad' class='xr-var-data-in' type='checkbox'><label for='data-9004ad56-4cc0-4cca-b7c2-3384eb8c1aad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[-9.28677619e-01, -9.12156761e-01, -8.94809842e-01, ...,
              -9.67708111e-01, -9.56969738e-01, -9.43133473e-01],
             [-9.05682266e-01, -9.12177622e-01, -9.15457249e-01, ...,
              -8.71844172e-01, -8.85442317e-01, -8.97087276e-01],
             [-1.16406357e+00, -1.23160505e+00, -1.28302145e+00, ...,
              -9.03379381e-01, -9.96056259e-01, -1.08463359e+00],
             ...,
             [-1.75585821e-01, -1.76075116e-01, -1.75573900e-01, ...,
              -1.66714668e-01, -1.70317307e-01, -1.73800007e-01],
             [-1.43474877e-01, -1.36783600e-01, -1.30478472e-01, ...,
              -1.60485014e-01, -1.55592442e-01, -1.49569124e-01],
             [-1.49612337e-01, -1.39794454e-01, -1.29976541e-01, ...,
              -1.76677883e-01, -1.68230951e-01, -1.58811092e-01]],

            [[-7.31624484e-01, -7.19980180e-01, -7.05055714e-01, ...,
              -7.60817170e-01, -7.52617002e-01, -7.42776632e-01],
             [-7.17676818e-01, -7.22057879e-01, -7.23932683e-01, ...,
              -6.89850092e-01, -7.00998783e-01, -7.11117268e-01],
             [-9.35872138e-01, -9.91929948e-01, -1.03393590e+00, ...,
              -7.23102272e-01, -7.98541546e-01, -8.70113552e-01],
    ...
               4.77810623e-04,  1.04721962e-03,  1.73542392e-03],
             [ 5.91062335e-03,  6.91751717e-03,  7.89710786e-03, ...,
               2.98286392e-03,  3.95420659e-03,  4.93401149e-03],
             [ 8.17751233e-03,  9.70098283e-03,  1.11745000e-02, ...,
               3.58925620e-03,  5.12343226e-03,  6.68614730e-03]],

            [[ 2.77480227e-04,  4.50455263e-04,  6.18024555e-04, ...,
              -2.66669784e-04, -9.00913801e-05,  8.64871035e-05],
             [-2.98992149e-03, -3.02977231e-03, -3.04939901e-03, ...,
              -2.86408933e-03, -2.88517820e-03, -2.94567435e-03],
             [-3.80958477e-03, -4.45881067e-03, -5.13322232e-03, ...,
              -2.36102776e-03, -2.70353653e-03, -3.21330922e-03],
             ...,
             [ 4.35454887e-04,  5.30001416e-04,  6.31168426e-04, ...,
               1.99651506e-04,  2.70568387e-04,  3.50068934e-04],
             [ 1.03582791e-03,  1.18577783e-03,  1.31927594e-03, ...,
               5.64198184e-04,  7.26516591e-04,  8.87191389e-04],
             [ 1.50268292e-03,  1.81051216e-03,  2.10782280e-03, ...,
               5.73586614e-04,  8.84920824e-04,  1.19415275e-03]]]],
          dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a1198ccf-3bdb-4626-899b-6a6eb234b67a' class='xr-section-summary-in' type='checkbox'  ><label for='section-a1198ccf-3bdb-4626-899b-6a6eb234b67a' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0efd52b2-4583-46a8-b25d-b61f8eccb5ea' class='xr-index-data-in' type='checkbox'/><label for='index-0efd52b2-4583-46a8-b25d-b61f8eccb5ea' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a467fa64-e56d-403a-9865-f8b603b83b7f' class='xr-index-data-in' type='checkbox'/><label for='index-a467fa64-e56d-403a-9865-f8b603b83b7f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7216cbb7-5164-441d-ab94-1b4e5f5fbe8f' class='xr-index-data-in' type='checkbox'/><label for='index-7216cbb7-5164-441d-ab94-1b4e5f5fbe8f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0c1729d4-6cd6-497f-a1a5-11f371e0484a' class='xr-index-data-in' type='checkbox'/><label for='index-0c1729d4-6cd6-497f-a1a5-11f371e0484a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([1000.0, 925.0, 850.0, 700.0, 600.0, 500.0, 400.0, 300.0], dtype=&#x27;float64&#x27;, name=&#x27;level&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-88167a2b-ba44-46ff-a4e2-81383ca9bbf7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-88167a2b-ba44-46ff-a4e2-81383ca9bbf7' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 355-356

The whole layer integral needs to consider the function :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>` to calculate.

.. GENERATED FROM PYTHON SOURCE LINES 356-369

.. code-block:: default


    water_flux_top2surface_integral = ecl.calc_water_flux_top2surface_integral(
        specific_humidity_data = q_data, 
        u_data = u_data, 
        v_data = v_data,
        surface_pressure_data = msl_data, 
        surface_pressure_data_units = 'millibars',
        vertical_dim = 'level', 
        vertical_dim_units = 'hPa',
    )

    water_flux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (time: 2, lon: 144, lat: 73)
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
    Data variables:
        qu       (time, lat, lon) float32 764.1 420.4 ... -2.405e+04 -2.415e+04
        qv       (time, lat, lon) float32 7.884e+03 7.905e+03 ... -1.976e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-168fe639-6ca4-4295-bcdb-b495ef9968dd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-168fe639-6ca4-4295-bcdb-b495ef9968dd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e1fcc556-98e1-4b8e-92cf-d989d9a5002d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e1fcc556-98e1-4b8e-92cf-d989d9a5002d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-75f45f87-135f-422e-8273-eceff6e8db11' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-75f45f87-135f-422e-8273-eceff6e8db11' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e861eb7f-8e37-4e67-b3ad-c24e839a1f98' class='xr-var-data-in' type='checkbox'><label for='data-e861eb7f-8e37-4e67-b3ad-c24e839a1f98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-cab7a75d-4743-45c6-aa47-c8fe2e0f6913' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cab7a75d-4743-45c6-aa47-c8fe2e0f6913' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06c97b38-2cdd-4850-ba0f-99420a529f19' class='xr-var-data-in' type='checkbox'><label for='data-06c97b38-2cdd-4850-ba0f-99420a529f19' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-739343f5-c43f-4989-b5b0-c5cb5e84adde' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-739343f5-c43f-4989-b5b0-c5cb5e84adde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02b34555-bfe5-4c9f-9bfc-591ec618f144' class='xr-var-data-in' type='checkbox'><label for='data-02b34555-bfe5-4c9f-9bfc-591ec618f144' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-62343f66-2879-46d0-89ba-d00fe345e46d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-62343f66-2879-46d0-89ba-d00fe345e46d' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>764.1 420.4 ... -2.415e+04</div><input id='attrs-7a95d38c-5774-4fcb-ba1d-060370444304' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a95d38c-5774-4fcb-ba1d-060370444304' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e66586ed-ee4e-4bfb-bbdc-2011b46c1ff4' class='xr-var-data-in' type='checkbox'><label for='data-e66586ed-ee4e-4bfb-bbdc-2011b46c1ff4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[   764.1305 ,    420.386  ,     41.37965, ...,   1754.9336 ,
               1408.9583 ,   1111.3759 ],
            [  2888.3228 ,   2628.0552 ,   2389.276  , ...,   3665.8916 ,
               3424.9082 ,   3215.754  ],
            [   947.62415,    694.2946 ,    401.24915, ...,   1777.574  ,
               1493.9509 ,   1255.2438 ],
            ...,
            [-10500.327  , -11242.958  , -11988.612  , ...,  -8289.951  ,
              -9007.941  ,  -9734.624  ],
            [-12183.795  , -12402.442  , -12612.091  , ..., -11504.028  ,
             -11724.952  , -11951.933  ],
            [-15247.002  , -15466.363  , -15664.332  , ..., -14401.904  ,
             -14706.968  , -14991.695  ]],

           [[  2536.8816 ,   2174.4268 ,   1812.0328 , ...,   3582.4114 ,
               3247.1133 ,   2892.419  ],
            [  3421.082  ,   3258.8306 ,   3107.3137 , ...,   3943.8455 ,
               3758.8271 ,   3592.8806 ],
            [  3346.2932 ,   3641.9219 ,   3921.0427 , ...,   2589.7036 ,
               2772.7332 ,   3036.336  ],
            ...,
            [ -8941.726  ,  -9802.936  , -10667.026  , ...,  -6543.59   ,
              -7298.8247 ,  -8107.329  ],
            [-17655.908  , -17937.752  , -18217.6    , ..., -16691.25   ,
             -17021.02   , -17340.396  ],
            [-24214.209  , -24232.627  , -24206.156  , ..., -23887.533  ,
             -24046.729  , -24154.074  ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>7.884e+03 7.905e+03 ... -1.976e+03</div><input id='attrs-af90d507-fd0c-4b71-8b29-5c0621dd1529' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-af90d507-fd0c-4b71-8b29-5c0621dd1529' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b37df271-3ba5-41da-9ad1-65b512ded670' class='xr-var-data-in' type='checkbox'><label for='data-b37df271-3ba5-41da-9ad1-65b512ded670' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[ 7883.659  ,  7905.0005 ,  7958.5405 , ...,  7734.329  ,
              7816.0127 ,  7834.132  ],
            [ 5235.9478 ,  5501.0444 ,  5734.6694 , ...,  4427.38   ,
              4702.162  ,  4980.545  ],
            [ 7450.4116 ,  7791.355  ,  8025.6284 , ...,  5602.8    ,
              6343.4473 ,  6962.0586 ],
            ...,
            [-7246.3057 , -7228.243  , -7149.3955 , ..., -6951.0054 ,
             -7099.7163 , -7201.847  ],
            [-4956.352  , -4603.5    , -4242.636  , ..., -5917.206  ,
             -5606.452  , -5287.6064 ],
            [-5470.336  , -4798.7974 , -4126.2026 , ..., -7418.8403 ,
             -6780.4375 , -6127.9463 ]],

           [[ 8228.076  ,  8342.619  ,  8418.245  , ...,  7842.9697 ,
              7988.952  ,  8124.053  ],
            [ 3624.8127 ,  3730.7979 ,  3883.9333 , ...,  3271.8242 ,
              3390.2607 ,  3505.3909 ],
            [ 2831.7595 ,  3149.7505 ,  3397.659  , ...,  1891.5964 ,
              2185.9998 ,  2494.4062 ],
            ...,
            [-5310.676  , -4914.6494 , -4417.6567 , ..., -5789.008  ,
             -5735.0073 , -5571.867  ],
            [-2336.2898 , -1571.1039 ,  -777.90063, ..., -4423.016  ,
             -3761.101  , -3064.675  ],
            [ -919.7678 ,   132.96321,  1190.7288 , ..., -4073.0735 ,
             -3036.5168 , -1975.7177 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa34b25d-d2ec-4c5e-9c81-80a6ebe13fae' class='xr-section-summary-in' type='checkbox'  ><label for='section-fa34b25d-d2ec-4c5e-9c81-80a6ebe13fae' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-09692def-30a4-417e-926e-6d1b51f78097' class='xr-index-data-in' type='checkbox'/><label for='index-09692def-30a4-417e-926e-6d1b51f78097' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-961a5791-bf6f-4f5d-89f8-739977778a00' class='xr-index-data-in' type='checkbox'/><label for='index-961a5791-bf6f-4f5d-89f8-739977778a00' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-14c258dd-f771-4634-a83b-9b3f9434bfe9' class='xr-index-data-in' type='checkbox'/><label for='index-14c258dd-f771-4634-a83b-9b3f9434bfe9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d7c8ac71-5746-4897-9143-f1bcce3c2018' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d7c8ac71-5746-4897-9143-f1bcce3c2018' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 370-371

Extracting the entire layer water vapor flux at mid and low latitudes at the 0th time level.

.. GENERATED FROM PYTHON SOURCE LINES 371-375

.. code-block:: default


    draw_water_flux = water_flux_top2surface_integral.isel(time = 0).thin(lon = 3, lat = 3).sel(lat = slice(-60, 60))
    draw_pr = pr_data.isel(time = 0).sel(lat = slice(-60, 60))








.. GENERATED FROM PYTHON SOURCE LINES 376-403

.. code-block:: default

    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(
        draw_labels = ['bottom', 'left'], 
        color = "grey", 
        alpha = 0.5, 
        linestyle="--"
    )
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    draw_water_flux.plot.quiver(
        ax = ax,
        u = 'qu', v = 'qv', x = 'lon', y = 'lat',
        transform = ccrs.PlateCarree(),
        zorder = 2,
    )

    draw_pr.plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        levels = 21,
        cmap = 'Greens',
        zorder = 1,
        cbar_kwargs = {'location': 'bottom'},
        vmax = 20
    )




.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_015.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_015.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000001E4B636AAA0>



.. GENERATED FROM PYTHON SOURCE LINES 404-415

Water Vapor Flux Divergence
--------------------------------------

Water vapor flux divergence represents the convergence and divergence of water vapor. There are also two built-in functions to calculate the results of single-layers and whole-layer integration respectively.

- :py:func:`easyclimate.calc_divergence_watervaporflux <easyclimate.calc_divergence_watervaporflux>`: calculate water vapor flux divergence at each vertical level.

.. math::
  \nabla \left( \frac{1}{g} q \mathbf{V} \right) = \frac{1}{g} \nabla \cdot \left( q \mathbf{V} \right)

- :py:func:`easyclimate.calc_divergence_watervaporflux_top2surface_integral <easyclimate.calc_divergence_watervaporflux_top2surface_integral>`: calculate water vapor flux divergence across the vertical level.

.. GENERATED FROM PYTHON SOURCE LINES 415-429

.. code-block:: default


    divergence_watervaporflux_top2surface_integral = ecl.calc_divergence_watervaporflux_top2surface_integral(
        specific_humidity_data = q_data,
        u_data = u_data,
        v_data = v_data,
        surface_pressure_data = msl_data,
        surface_pressure_data_units = 'millibars',
        specific_humidity_units = 'grams/kg',
        vertical_dim = 'level',
        vertical_dim_units = 'hPa'
    )

    divergence_watervaporflux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 2, lat: 73, lon: 144)&gt;
    array([[[-1.47138916e-03,  1.35440704e-03,  2.12104024e-04, ...,
              7.63451213e-04, -1.58517398e-03, -5.63335615e-03],
            [-8.78047936e-10,  2.77973368e-09,  9.07116751e-10, ...,
             -5.38412165e-09, -1.66413833e-09,  3.44718846e-09],
            [ 1.05444328e-08,  9.55497729e-09,  1.08459571e-08, ...,
              3.05369584e-09,  6.10039023e-09,  1.00502167e-08],
            ...,
            [-8.28521914e-09, -7.65947810e-09, -7.18742773e-09, ...,
             -1.11239579e-08, -1.00659209e-08, -8.98731767e-09],
            [ 1.89051734e-09,  2.56174589e-09,  1.98235108e-09, ...,
              1.06464441e-09,  1.55097810e-09,  1.23327180e-09],
            [-7.10215410e-04, -5.94130008e-05,  5.79028246e-05, ...,
              9.31174891e-05, -7.87465841e-05,  5.90777114e-04]],

           [[ 2.85382646e-04, -1.30979441e-04,  6.43686898e-04, ...,
             -5.03265810e-04, -2.95329631e-04,  8.16090931e-04],
            [-1.06686347e-08, -8.79369365e-09, -8.82426665e-09, ...,
             -1.54865663e-08, -1.35132826e-08, -1.08642684e-08],
            [ 1.98332477e-08,  1.98366959e-08,  1.80170149e-08, ...,
              9.48953545e-09,  1.35660861e-08,  1.84950117e-08],
            ...,
            [-1.62302742e-08, -1.57168156e-08, -1.57410230e-08, ...,
             -1.56846938e-08, -1.57971339e-08, -1.63707830e-08],
            [-8.02328376e-09, -9.43031007e-09, -9.74286703e-09, ...,
             -1.01034135e-08, -9.31232781e-09, -9.39057441e-09],
            [ 5.98618235e-05,  1.46056969e-04,  9.44555694e-05, ...,
              1.38477774e-04,  6.39792612e-05, -3.94048290e-04]]])
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
    Attributes:
        Vertical integral method:  Trenberth-vibeta</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-adeaddfd-a6c5-4974-800a-c4c3a04b7bff' class='xr-array-in' type='checkbox' checked><label for='section-adeaddfd-a6c5-4974-800a-c4c3a04b7bff' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.001471 0.001354 0.0002121 ... 0.0001385 6.398e-05 -0.000394</span></div><div class='xr-array-data'><pre>array([[[-1.47138916e-03,  1.35440704e-03,  2.12104024e-04, ...,
              7.63451213e-04, -1.58517398e-03, -5.63335615e-03],
            [-8.78047936e-10,  2.77973368e-09,  9.07116751e-10, ...,
             -5.38412165e-09, -1.66413833e-09,  3.44718846e-09],
            [ 1.05444328e-08,  9.55497729e-09,  1.08459571e-08, ...,
              3.05369584e-09,  6.10039023e-09,  1.00502167e-08],
            ...,
            [-8.28521914e-09, -7.65947810e-09, -7.18742773e-09, ...,
             -1.11239579e-08, -1.00659209e-08, -8.98731767e-09],
            [ 1.89051734e-09,  2.56174589e-09,  1.98235108e-09, ...,
              1.06464441e-09,  1.55097810e-09,  1.23327180e-09],
            [-7.10215410e-04, -5.94130008e-05,  5.79028246e-05, ...,
              9.31174891e-05, -7.87465841e-05,  5.90777114e-04]],

           [[ 2.85382646e-04, -1.30979441e-04,  6.43686898e-04, ...,
             -5.03265810e-04, -2.95329631e-04,  8.16090931e-04],
            [-1.06686347e-08, -8.79369365e-09, -8.82426665e-09, ...,
             -1.54865663e-08, -1.35132826e-08, -1.08642684e-08],
            [ 1.98332477e-08,  1.98366959e-08,  1.80170149e-08, ...,
              9.48953545e-09,  1.35660861e-08,  1.84950117e-08],
            ...,
            [-1.62302742e-08, -1.57168156e-08, -1.57410230e-08, ...,
             -1.56846938e-08, -1.57971339e-08, -1.63707830e-08],
            [-8.02328376e-09, -9.43031007e-09, -9.74286703e-09, ...,
             -1.01034135e-08, -9.31232781e-09, -9.39057441e-09],
            [ 5.98618235e-05,  1.46056969e-04,  9.44555694e-05, ...,
              1.38477774e-04,  6.39792612e-05, -3.94048290e-04]]])</pre></div></div></li><li class='xr-section-item'><input id='section-06ab3978-976f-4609-bf3e-f5c6694f6aee' class='xr-section-summary-in' type='checkbox'  checked><label for='section-06ab3978-976f-4609-bf3e-f5c6694f6aee' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-9fb79884-058d-4907-93aa-1ac5a15677c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9fb79884-058d-4907-93aa-1ac5a15677c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4af46c6-3e62-4882-8d96-644b08a2b35d' class='xr-var-data-in' type='checkbox'><label for='data-f4af46c6-3e62-4882-8d96-644b08a2b35d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-2c0f52c7-a974-48c4-8ba6-a14b1638a7e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c0f52c7-a974-48c4-8ba6-a14b1638a7e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1df972e9-41a0-49ed-bbee-dc1e01858032' class='xr-var-data-in' type='checkbox'><label for='data-1df972e9-41a0-49ed-bbee-dc1e01858032' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-46ba6de7-4e84-4e51-96da-16db8720b91b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46ba6de7-4e84-4e51-96da-16db8720b91b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93216fc5-468b-419e-a159-c4bd7bee7634' class='xr-var-data-in' type='checkbox'><label for='data-93216fc5-468b-419e-a159-c4bd7bee7634' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89b1cf06-3dd1-4d7a-b0a3-591a9b033104' class='xr-section-summary-in' type='checkbox'  ><label for='section-89b1cf06-3dd1-4d7a-b0a3-591a9b033104' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8cd61713-dc8a-49af-9133-8aebb349566b' class='xr-index-data-in' type='checkbox'/><label for='index-8cd61713-dc8a-49af-9133-8aebb349566b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-15e7e759-2d94-44c0-98b0-d59a5538a0a1' class='xr-index-data-in' type='checkbox'/><label for='index-15e7e759-2d94-44c0-98b0-d59a5538a0a1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2d01dce6-e709-4a3e-9e0b-33c6140645d7' class='xr-index-data-in' type='checkbox'/><label for='index-2d01dce6-e709-4a3e-9e0b-33c6140645d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0a40e3b2-010a-4cfa-9866-f1750d2ca3fa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0a40e3b2-010a-4cfa-9866-f1750d2ca3fa' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 430-431

Extracting the entire layer water vapor flux at mid and low latitudes at the 0th time level.

.. GENERATED FROM PYTHON SOURCE LINES 431-434

.. code-block:: default


    draw_data = divergence_watervaporflux_top2surface_integral.isel(time = 0).sel(lat = slice(-60, 60))








.. GENERATED FROM PYTHON SOURCE LINES 436-452

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(
        draw_labels = ['bottom', 'left'], 
        color = "grey", 
        alpha = 0.5, 
        linestyle="--"
    )
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    draw_data.plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        cbar_kwargs = {'location': 'bottom'},
        levels = 21
    )


.. image-sg:: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_016.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery_output/images/sphx_glr_plot_geographic_finite_difference_016.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000001E4B18F09D0>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  12.615 seconds)


.. _sphx_glr_download_auto_gallery_output_plot_geographic_finite_difference.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_geographic_finite_difference.py <plot_geographic_finite_difference.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_geographic_finite_difference.ipynb <plot_geographic_finite_difference.ipynb>`
