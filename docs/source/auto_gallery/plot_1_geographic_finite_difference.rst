
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery\plot_1_geographic_finite_difference.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_gallery_plot_1_geographic_finite_difference.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_plot_1_geographic_finite_difference.py:


Geographic finite difference
===================================

Before proceeding with all the steps, first import some necessary libraries and packages

.. GENERATED FROM PYTHON SOURCE LINES 8-15

.. code-block:: default

    import easyclimate as ecl
    import xarray as xr
    import numpy as np
    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    from pathlib import Path








.. GENERATED FROM PYTHON SOURCE LINES 16-17

Then consider obtaining meridional and zonal wind variables in tutorial data

.. GENERATED FROM PYTHON SOURCE LINES 17-45

.. code-block:: default


    eclcache_path = Path('F:/EASYclimate/doc_jupyter/data_ncep')

    u_path = eclcache_path / 'uwnd.202201.mon.mean.nc'
    u_data = xr.open_dataset(u_path).sortby('lat').uwnd

    v_path = eclcache_path / 'vwnd.202201.mon.mean.nc'
    v_data = xr.open_dataset(v_path).sortby('lat').vwnd

    z_path = eclcache_path / 'hgt.202201.mon.mean.nc'
    z_data = xr.open_dataset(z_path).sortby('lat').hgt

    temp_path = eclcache_path / 'air.202201.mon.mean.nc'
    temp_data = xr.open_dataset(temp_path).sortby('lat').air

    q_path = eclcache_path / 'shum.202201.mon.mean.nc'
    q_data = xr.open_dataset(q_path).sortby('lat').shum

    msl_path = eclcache_path / 'pres.sfc.202201.mon.mean.nc'
    msl_data = xr.open_dataset(msl_path).sortby('lat').pres

    pr_path = eclcache_path / 'precip.202201.mon.mean.nc'
    pr_data = xr.open_dataset(pr_path).sortby('lat').precip

    uvdata = xr.Dataset()
    uvdata['uwnd'] = u_data
    uvdata['vwnd'] = v_data








.. GENERATED FROM PYTHON SOURCE LINES 46-47

Obtain data slices on 500hPa isobars for January 2022

.. GENERATED FROM PYTHON SOURCE LINES 47-52

.. code-block:: default


    uvdata_500_202201 = uvdata.sel(level = 500, time = '2022-01-01')
    z_data_500_202201 = z_data.sel(level = 500, time = '2022-01-01')
    temp_data_500_202201 = temp_data.sel(level = 500, time = '2022-01-01')








.. GENERATED FROM PYTHON SOURCE LINES 53-54

Plotting a sample `quiver` plot of this data slice

.. GENERATED FROM PYTHON SOURCE LINES 54-68

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.stock_img()
    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uvdata_500_202201.thin(lon = 3, lat = 3).plot.quiver(
        ax = ax,
        u = 'uwnd', v = 'vwnd', x = 'lon', y = 'lat',
        # projection on data
        transform = ccrs.PlateCarree(),
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_001.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.quiver.Quiver object at 0x000002360A725B40>



.. GENERATED FROM PYTHON SOURCE LINES 69-79

First-order partial derivative
-------------------------------------

Consider the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to compute the gradient of the zonal wind with respect to longitude.

.. math::

  \frac{\partial u}{\partial \lambda}

The argument `dim` to the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` specifies that the direction of the solution is `longitude`.

.. GENERATED FROM PYTHON SOURCE LINES 79-83

.. code-block:: default


    uwnd_dx = ecl.calc_gradient(uvdata_500_202201.uwnd, dim = 'lon')
    uwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;uwnd&#x27; (lat: 73, lon: 144)&gt;
    array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)
    Coordinates:
        time     datetime64[ns] 2022-01-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
        level    float32 500.0
    Attributes:
        long_name:     Monthly mean u wind
        units:         m/s
        precision:     2
        var_desc:      u-wind
        level_desc:    Pressure Levels
        statistic:     Mean
        parent_stat:   Other
        dataset:       NCEP Reanalysis Derived Products
        actual_range:  [-68.194824 124.399994]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'uwnd'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d93b3ef7-6ae4-4d9d-8450-dbb618bbed61' class='xr-array-in' type='checkbox' checked><label for='section-d93b3ef7-6ae4-4d9d-8450-dbb618bbed61' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.15 0.1323 0.1185 0.1125 ... -0.08952 -0.0754 -0.06532 -0.06694</span></div><div class='xr-array-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-be5e2f01-1fc0-4aba-aefa-3fa65702666e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-be5e2f01-1fc0-4aba-aefa-3fa65702666e' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-96067b88-10e3-4463-8eec-39611b0ae5df' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-96067b88-10e3-4463-8eec-39611b0ae5df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c280c72-5f09-47ce-b910-8654b6ab9188' class='xr-var-data-in' type='checkbox'><label for='data-2c280c72-5f09-47ce-b910-8654b6ab9188' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-a1f62b27-0ef8-4294-aa64-fd5cccf59bed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1f62b27-0ef8-4294-aa64-fd5cccf59bed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf93f198-dc04-4097-9531-ef005ff1da34' class='xr-var-data-in' type='checkbox'><label for='data-cf93f198-dc04-4097-9531-ef005ff1da34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-1e96475e-d275-4d12-8860-a73560629874' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e96475e-d275-4d12-8860-a73560629874' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d24731b3-acb1-4661-b099-72264f96ff65' class='xr-var-data-in' type='checkbox'><label for='data-d24731b3-acb1-4661-b099-72264f96ff65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-e0de8ba8-7791-4e2c-8ea8-8e7c128f9c76' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e0de8ba8-7791-4e2c-8ea8-8e7c128f9c76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d021ab3-e0e0-4383-a272-98ed043886e3' class='xr-var-data-in' type='checkbox'><label for='data-6d021ab3-e0e0-4383-a272-98ed043886e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-030dfcef-ede6-4d45-8a3f-50cb5449a69e' class='xr-section-summary-in' type='checkbox'  ><label for='section-030dfcef-ede6-4d45-8a3f-50cb5449a69e' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b0ead327-8298-4115-936d-7305a4e81528' class='xr-index-data-in' type='checkbox'/><label for='index-b0ead327-8298-4115-936d-7305a4e81528' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-34c546ff-ea6b-4cd2-bc5d-24473af51641' class='xr-index-data-in' type='checkbox'/><label for='index-34c546ff-ea6b-4cd2-bc5d-24473af51641' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dbcdcd45-84ac-4d6c-b03d-bea4acdac7c1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dbcdcd45-84ac-4d6c-b03d-bea4acdac7c1' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 84-100

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.stock_img()
    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dx.plot.contourf(
        ax = ax,
        # projection on data
        transform = ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs = {'location': 'bottom'},
        levels = 21,
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_002.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000002360A993670>



.. GENERATED FROM PYTHON SOURCE LINES 101-102

Of course, it is also possible to pass in :py:class:`xarray.Dataset<xarray.Dataset>` directly into the function :py:func:`easyclimate.calc_gradient <easyclimate.calc_gradient>` to iterate through all the variables, so that you can get the gradient of both the zonal and meridional winds with respect to longitude at the same time.

.. GENERATED FROM PYTHON SOURCE LINES 102-106

.. code-block:: default


    uvwnd_dx = ecl.calc_gradient(uvdata_500_202201, dim = 'lon')
    uvwnd_dx






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (lon: 144, lat: 73)
    Coordinates:
        time     datetime64[ns] 2022-01-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
        level    float32 500.0
    Data variables:
        uwnd     (lat, lon) float32 0.15 0.1323 0.1185 ... -0.0754 -0.06532 -0.06694
        vwnd     (lat, lon) float32 0.1734 0.1815 0.1895 ... 0.2218 0.2234 0.2137</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-abf158ea-f3b9-431f-a450-330bca04c407' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-abf158ea-f3b9-431f-a450-330bca04c407' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-da7f3367-da44-4130-81af-c8abd885c1b1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-da7f3367-da44-4130-81af-c8abd885c1b1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-cb262384-d28d-4de3-a78b-b718a70b5e34' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb262384-d28d-4de3-a78b-b718a70b5e34' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-009b71bc-049f-4ada-9073-747e14c7dd7e' class='xr-var-data-in' type='checkbox'><label for='data-009b71bc-049f-4ada-9073-747e14c7dd7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-e7e31b8d-8211-4518-b93b-a426a5dbf130' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e7e31b8d-8211-4518-b93b-a426a5dbf130' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7be8a2e-005e-4e14-849d-54905b3e6e70' class='xr-var-data-in' type='checkbox'><label for='data-b7be8a2e-005e-4e14-849d-54905b3e6e70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-cb6c5e18-ccab-41d9-8092-200ffeb72765' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb6c5e18-ccab-41d9-8092-200ffeb72765' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d255284-dd18-4b67-9feb-4146f6cce682' class='xr-var-data-in' type='checkbox'><label for='data-7d255284-dd18-4b67-9feb-4146f6cce682' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-78406ddf-e2b5-407c-b771-406fe0076ef0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-78406ddf-e2b5-407c-b771-406fe0076ef0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f5bef20-56fd-4e8a-bc2b-c96cdf8e7a6f' class='xr-var-data-in' type='checkbox'><label for='data-1f5bef20-56fd-4e8a-bc2b-c96cdf8e7a6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-42c62700-6134-432f-9253-0c5cb1a689c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-42c62700-6134-432f-9253-0c5cb1a689c6' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.15 0.1323 ... -0.06532 -0.06694</div><input id='attrs-74d68071-c10b-4fce-b9a2-96946157d5bf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-74d68071-c10b-4fce-b9a2-96946157d5bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73732dcf-adda-4dd4-8e2e-b4dea59f80ae' class='xr-var-data-in' type='checkbox'><label for='data-73732dcf-adda-4dd4-8e2e-b4dea59f80ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean u wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>u-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.194824 124.399994]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.14999962,  0.13225818,  0.11854815, ...,  0.15927446,
             0.15080655,  0.14274216],
           [ 0.25967765,  0.25645185,  0.24798417, ...,  0.27499998,
             0.27661264,  0.27983665],
           [ 0.33306527,  0.30725718,  0.2846775 , ...,  0.35040367,
             0.34435558,  0.34112835],
           ...,
           [-0.1056456 , -0.12661296, -0.13790333, ..., -0.08024192,
            -0.09354854, -0.11290336],
           [-0.07903278, -0.08870995, -0.09435463, ..., -0.08266127,
            -0.08064544, -0.07741928],
           [-0.0576601 , -0.03749967, -0.02540326, ..., -0.07540298,
            -0.06532216, -0.06693745]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vwnd</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1734 0.1815 ... 0.2234 0.2137</div><input id='attrs-7c7d05d7-076e-4e2b-bb90-afa22ddc8c90' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c7d05d7-076e-4e2b-bb90-afa22ddc8c90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef411cc7-6371-4f6c-8d1e-ab24175303f2' class='xr-var-data-in' type='checkbox'><label for='data-ef411cc7-6371-4f6c-8d1e-ab24175303f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Monthly mean v wind</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>var_desc :</span></dt><dd>v-wind</dd><dt><span>level_desc :</span></dt><dd>Pressure Levels</dd><dt><span>statistic :</span></dt><dd>Mean</dd><dt><span>parent_stat :</span></dt><dd>Other</dd><dt><span>dataset :</span></dt><dd>NCEP Reanalysis Derived Products</dd><dt><span>actual_range :</span></dt><dd>[-68.57001  68.56999]</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.17338598,  0.1814518 ,  0.18951654, ...,  0.15846789,
             0.1677419 ,  0.17258167],
           [ 0.1516118 ,  0.16128993,  0.18346763, ...,  0.08145142,
             0.09516072,  0.10322666],
           [ 0.1903243 ,  0.24516177,  0.28387117, ...,  0.06572509,
             0.11209702,  0.16209793],
           ...,
           [-0.02338713, -0.00887108,  0.00120991, ..., -0.0399195 ,
            -0.03588688, -0.02540255],
           [ 0.10685444,  0.11249995,  0.11653227, ...,  0.09112895,
             0.09274191,  0.10564566],
           [ 0.22661296,  0.22983876,  0.2318549 , ...,  0.2217744 ,
             0.22338712,  0.21370983]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b1254675-0b07-416c-b25d-151275674d0b' class='xr-section-summary-in' type='checkbox'  ><label for='section-b1254675-0b07-416c-b25d-151275674d0b' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6996acb6-f5a1-4b72-ae43-abebe3c4e5ba' class='xr-index-data-in' type='checkbox'/><label for='index-6996acb6-f5a1-4b72-ae43-abebe3c4e5ba' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-be17b825-df07-4219-ab68-9f3ce2667ce0' class='xr-index-data-in' type='checkbox'/><label for='index-be17b825-df07-4219-ab68-9f3ce2667ce0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-26311c47-0b12-45d8-b9bb-5e08a8b5e6f3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-26311c47-0b12-45d8-b9bb-5e08a8b5e6f3' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 107-111

However, if one is required to solve for the gradient of the zonal wind with respect to the corresponding distance at each longitude, the function `calc_lon_gradient` should be used to calculate.

.. math::
  \frac{\partial F}{\partial x} = \frac{1}{R \cos\varphi} \cdot \frac{\partial F}{\partial \lambda}

.. GENERATED FROM PYTHON SOURCE LINES 111-128

.. code-block:: default


    uwnd_dlon = ecl.calc_lon_gradient(uvdata_500_202201.uwnd, lon_dim = 'lon', lat_dim = 'lat')

    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlon.plot.contourf(
        ax = ax,
        # projection on data
        transform = ccrs.PlateCarree(),
        # Colorbar is placed at the bottom
        cbar_kwargs = {'location': 'bottom'},
        levels = 21,
    )




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_003.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000002360ABD6D40>



.. GENERATED FROM PYTHON SOURCE LINES 129-130

Similarly, use :py:func:`easyclimate.calc_lat_gradient <easyclimate.calc_lat_gradient>` to solve for the gradient of the meridional wind with respect to the corresponding distance at each latitude.

.. GENERATED FROM PYTHON SOURCE LINES 132-152

Second-order partial derivative
------------------------------------

The solution of the second-order partial derivative relies on three functional calculations

- :py:func:`easyclimate.calc_lon_laplacian <easyclimate.calc_lon_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along longitude.

.. math::
  \frac{\partial^2 F}{\partial x^2} = \frac{1}{(R \cos\varphi)^2} \cdot \frac{\partial^2 F}{\partial \lambda^2}

- :py:func:`easyclimate.calc_lat_laplacian <easyclimate.calc_lat_laplacian>`: calculation of the second-order partial derivative term (Laplace term) along latitude.

.. math::
  \frac{\partial^2 F}{\partial y^2} = \frac{1}{R^2} \cdot \frac{\partial^2 F}{\partial \varphi^2}

- :py:func:`easyclimate.calc_lon_lat_mixed_derivatives <easyclimate.calc_lon_lat_mixed_derivatives>`: second-order mixed partial derivative terms along longitude and latitude.

.. math::
  \frac{\partial^2 F}{\partial x \partial y} = \frac{1}{R^2 \cos\varphi} \cdot \frac{\partial^2 F}{\partial \lambda \partial \varphi}


.. GENERATED FROM PYTHON SOURCE LINES 152-157

.. code-block:: default


    uwnd_dlon2 = ecl.calc_lon_laplacian(uvdata_500_202201.uwnd, lon_dim = 'lon', lat_dim = 'lat')
    uwnd_dlat2 = ecl.calc_lat_laplacian(uvdata_500_202201.uwnd, lat_dim = 'lat')
    uwnd_dlonlat = ecl.calc_lon_lat_mixed_derivatives(uvdata_500_202201.uwnd, lon_dim = 'lon', lat_dim = 'lat')








.. GENERATED FROM PYTHON SOURCE LINES 158-167

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlon2.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial x^2}$', fontsize = 20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_004.png
   :alt: $\frac{\partial^2 F}{\partial x^2}$
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0326797365031362, '$\\frac{\\partial^2 F}{\\partial x^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 168-177

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlat2.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial y^2}$', fontsize = 20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_005.png
   :alt: $\frac{\partial^2 F}{\partial y^2}$
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0480710965501792, '$\\frac{\\partial^2 F}{\\partial y^2}$')



.. GENERATED FROM PYTHON SOURCE LINES 178-187

.. code-block:: default


    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    uwnd_dlonlat.plot.contourf(ax = ax, transform = ccrs.PlateCarree(), cbar_kwargs = {'location': 'bottom'}, levels = 21)
    ax.set_title('$\\frac{\\partial^2 F}{\\partial x \\partial y}$', fontsize = 20)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_006.png
   :alt: $\frac{\partial^2 F}{\partial x \partial y}$
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0287305387544805, '$\\frac{\\partial^2 F}{\\partial x \\partial y}$')



.. GENERATED FROM PYTHON SOURCE LINES 188-198

Vorticity and divergence
------------------------------------

Vorticity and divergence are measures of the degree of atmospheric rotation and volumetric flux per unit volume respectively. For vorticity and divergence in the quasi-geostrophic case, the potential height is used as input data for the calculations. In general, we first calculate the quasi-geostrophic wind.

- :py:func:`easyclimate.calc_geostrophic_wind <easyclimate.calc_geostrophic_wind>`: calculate the geostrophic wind. 

.. math::
  u_g = - \frac{g}{f} \frac{\partial H}{\partial y}, \ v_g = \frac{g}{f} \frac{\partial H}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 198-202

.. code-block:: default


    geostrophic_wind_data_500_202201 = ecl.calc_geostrophic_wind(z_data_500_202201, lon_dim = 'lon', lat_dim = 'lat')
    geostrophic_wind_data_500_202201






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (lat: 73, lon: 144)
    Coordinates:
        time     datetime64[ns] 2022-01-01
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
        level    float32 500.0
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
    Data variables:
        ug       (lat, lon) float64 3.604 3.746 3.855 3.993 ... -5.199 -5.27 -5.333
        vg       (lat, lon) float64 0.0 0.0 0.0 0.0 0.0 ... -0.0 -0.0 -0.0 -0.0 -0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-706fce77-877a-42da-a83e-4ec1b5981269' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-706fce77-877a-42da-a83e-4ec1b5981269' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-45824da9-7c1f-4469-a439-aa421e79b307' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45824da9-7c1f-4469-a439-aa421e79b307' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01</div><input id='attrs-2f5afc24-54b6-48ea-af6d-5d7fb0cbb2d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f5afc24-54b6-48ea-af6d-5d7fb0cbb2d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3abd58cc-a8c0-43a1-b0f6-5e565a16bd3c' class='xr-var-data-in' type='checkbox'><label for='data-3abd58cc-a8c0-43a1-b0f6-5e565a16bd3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-6a319e6a-3c76-4390-8061-1de93794b26f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a319e6a-3c76-4390-8061-1de93794b26f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a97be06-0885-4ed8-8512-134ba1fd41e3' class='xr-var-data-in' type='checkbox'><label for='data-0a97be06-0885-4ed8-8512-134ba1fd41e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>500.0</div><input id='attrs-5d2503d8-f631-4ae1-b3d7-7fe4af939672' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d2503d8-f631-4ae1-b3d7-7fe4af939672' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d2ba128-0445-4e12-81ec-c3ef48c8b486' class='xr-var-data-in' type='checkbox'><label for='data-5d2ba128-0445-4e12-81ec-c3ef48c8b486' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd></dl></div><div class='xr-var-data'><pre>array(500., dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-bc5f5279-7a01-4fcd-9f5d-29afd074009a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc5f5279-7a01-4fcd-9f5d-29afd074009a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1ade8c1-919f-4cde-896f-5e1b7be40b0d' class='xr-var-data-in' type='checkbox'><label for='data-a1ade8c1-919f-4cde-896f-5e1b7be40b0d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6e969362-a17f-437f-9f0c-4899c041df5a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6e969362-a17f-437f-9f0c-4899c041df5a' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ug</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.604 3.746 3.855 ... -5.27 -5.333</div><input id='attrs-358548ed-66b2-4c4d-ad54-9d1807b0550b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-358548ed-66b2-4c4d-ad54-9d1807b0550b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4357c8a0-019f-4082-88df-c93846f6e1d5' class='xr-var-data-in' type='checkbox'><label for='data-4357c8a0-019f-4082-88df-c93846f6e1d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 3.60409775,  3.74628788,  3.85548329, ...,  3.16719807,
             3.31434626,  3.46456373],
           [ 4.22610743,  4.45835398,  4.68865087, ...,  3.48842478,
             3.74312203,  3.98316725],
           [ 4.97018748,  5.2354498 ,  5.49377986, ...,  4.07776376,
             4.38408634,  4.69129767],
           ...,
           [-1.14002953, -1.26332881, -1.4081951 , ..., -0.83767671,
            -0.92181173, -1.022596  ],
           [-3.32353032, -3.41717336, -3.51282515, ..., -3.05908474,
            -3.14398382, -3.23668157],
           [-5.40653029, -5.44170892, -5.45516651, ..., -5.19876389,
            -5.27006554, -5.3334579 ]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vg</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... -0.0 -0.0 -0.0</div><input id='attrs-d8d67ab6-c8db-461b-9526-7bfc48159670' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d8d67ab6-c8db-461b-9526-7bfc48159670' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4c5f688-8afe-4399-a987-b9ddb0838861' class='xr-var-data-in' type='checkbox'><label for='data-f4c5f688-8afe-4399-a987-b9ddb0838861' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.        ,  0.        ,  0.        , ...,  0.        ,
             0.        ,  0.        ],
           [-4.49410878, -4.09318769, -3.87105573, ..., -4.49546325,
            -4.54151499, -4.40742314],
           [-5.36647744, -5.32228932, -4.92935494, ..., -5.95112028,
            -5.69278972, -5.35696   ],
           ...,
           [-2.13190692, -2.1781345 , -2.21212536, ..., -1.93136083,
            -2.04353068, -2.22300244],
           [-1.58743083, -1.36394441, -1.65515399, ..., -1.90166628,
            -1.7906003 , -1.7906003 ],
           [-0.        , -0.        , -0.        , ..., -0.        ,
            -0.        , -0.        ]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-58534052-f037-49ce-91b6-3c6a6c70495f' class='xr-section-summary-in' type='checkbox'  ><label for='section-58534052-f037-49ce-91b6-3c6a6c70495f' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e9747b1d-7f5c-4ec1-91e5-25ae8acdd1ac' class='xr-index-data-in' type='checkbox'/><label for='index-e9747b1d-7f5c-4ec1-91e5-25ae8acdd1ac' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-00a35331-889b-4b2c-b6aa-6b3ee74f9143' class='xr-index-data-in' type='checkbox'/><label for='index-00a35331-889b-4b2c-b6aa-6b3ee74f9143' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fedbb6fc-99f0-44de-a663-310192ff7133' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fedbb6fc-99f0-44de-a663-310192ff7133' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 203-210

The function :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>` is then used to compute the quasi-geostrophic vorticity.

- :py:func:`easyclimate.calc_vorticity <easyclimate.calc_vorticity>`: calculate the horizontal relative vorticity term.

.. math::
  \zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} + \frac{u}{R} \tan \varphi


.. GENERATED FROM PYTHON SOURCE LINES 210-218

.. code-block:: default


    qg_vor_data_500_202201 = ecl.calc_vorticity(
        u_data = geostrophic_wind_data_500_202201.ug, 
        v_data = geostrophic_wind_data_500_202201.vg,
        lon_dim = 'lon', lat_dim = 'lat',
        )
    qg_vor_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_007.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360B342B30>



.. GENERATED FROM PYTHON SOURCE LINES 219-220

Similar vorticity for actual winds, but for actual winds rather than quasi-geostrophic winds.

.. GENERATED FROM PYTHON SOURCE LINES 220-228

.. code-block:: default


    vor_data_500_202201 = ecl.calc_vorticity(
        u_data = uvdata_500_202201['uwnd'], 
        v_data = uvdata_500_202201['vwnd'],
        lon_dim = 'lon', lat_dim = 'lat',
        )
    vor_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_008.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360B562CB0>



.. GENERATED FROM PYTHON SOURCE LINES 229-235

In addition, the function :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>` calculate the quasi-geostrophic divergence.

.. math::
  \mathrm{D} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} - \frac{v}{R} \tan \varphi

- :py:func:`easyclimate.calc_divergence <easyclimate.calc_divergence>`: calculate the horizontal divergence term.

.. GENERATED FROM PYTHON SOURCE LINES 235-245

.. code-block:: default


    # quasi-geostrophic divergence

    qg_div_data_500_202201 = ecl.calc_divergence(
        u_data = geostrophic_wind_data_500_202201.ug,
        v_data = geostrophic_wind_data_500_202201.vg,
        lon_dim = 'lon', lat_dim = 'lat',
        )
    qg_div_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_009.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360B77BF70>



.. GENERATED FROM PYTHON SOURCE LINES 246-256

.. code-block:: default


    # actual divergence

    div_data_500_202201 = ecl.calc_divergence(
        u_data = uvdata_500_202201['uwnd'], 
        v_data = uvdata_500_202201['vwnd'],
        lon_dim = 'lon', lat_dim = 'lat',
        )
    div_data_500_202201.sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_010.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360B9C8730>



.. GENERATED FROM PYTHON SOURCE LINES 257-258

Of course, in addition to the built-in finite difference method, the spherical harmonic function mothod can be solved, but you must ensure that it is **global** and **Regular or Gaussian** grid type data.

.. GENERATED FROM PYTHON SOURCE LINES 258-269

.. code-block:: default


    # - `windspharm.calc_relative_vorticity`: calculate the relative vorticity term with the spherical harmonic function mothod.
    # - `windspharm.calc_divergence`: calculate the horizontal divergence term with the spherical harmonic function mothod.

    vor_data_500_202201_windspharm = ecl.windspharm.calc_relative_vorticity(
        u = uvdata_500_202201['uwnd'],
        v = uvdata_500_202201['vwnd'],
    )

    vor_data_500_202201_windspharm.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_011.png
   :alt: plot 1 geographic finite difference
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_011.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360BBDE6B0>



.. GENERATED FROM PYTHON SOURCE LINES 270-278

.. code-block:: default


    div_data_500_202201_windspharm = ecl.windspharm.calc_divergence(
        u = uvdata_500_202201['uwnd'],
        v = uvdata_500_202201['vwnd'],
    )

    div_data_500_202201_windspharm.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_012.png
   :alt: plot 1 geographic finite difference
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360F0A3E80>



.. GENERATED FROM PYTHON SOURCE LINES 279-280

Generally speaking, the calculation results of the finite difference method and the spherical harmonic function method are similar. The former does not require global regional data, but the calculation results of the latter are more accurate for high latitude regions.

.. GENERATED FROM PYTHON SOURCE LINES 282-291

Advection
-------------------
`Advection <https://glossary.ametsoc.org/wiki/Advection>`__ is the process of transport of an atmospheric property solely by the mass motion (velocity field) of the atmosphere; also, the rate of change of the value of the advected property at a given point.

For zonal advection, we can calculate as follows.

.. math::
  -u \frac{\partial T}{\partial x}


.. GENERATED FROM PYTHON SOURCE LINES 291-298

.. code-block:: default


    u_advection_500_202201 = ecl.calc_u_advection(
        u_data = uvdata_500_202201['uwnd'],
        temper_data = temp_data_500_202201
    )
    u_advection_500_202201.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_013.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_013.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360F2E5C30>



.. GENERATED FROM PYTHON SOURCE LINES 299-304

Similarly, the meridional advection can acquire as follows.

.. math::
  -v \frac{\partial T}{\partial y}


.. GENERATED FROM PYTHON SOURCE LINES 304-311

.. code-block:: default


    v_advection_500_202201 = ecl.calc_v_advection(
        v_data = uvdata_500_202201['vwnd'],
        temper_data = temp_data_500_202201
    )
    v_advection_500_202201.sortby('lat').sel(lat = slice(20, 80)).plot.contourf(levels = 21)




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_014.png
   :alt: time = 2022-01-01, level = 500.0 [millibar]
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_014.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x000002360F512560>



.. GENERATED FROM PYTHON SOURCE LINES 312-328

Water flux
-------------------------

- :py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>`: calculate horizontal water vapor flux at each vertical level.

.. math::
  \frac{1}{g} q \mathbf{V} = \frac{1}{g} (u q\ \mathbf{i} + vq\ \mathbf{j})

- :py:func:`easyclimate.calc_vertical_water_flux <easyclimate.calc_vertical_water_flux>`: calculate vertical water vapor flux.

.. math::
  -\omega \frac{q}{g}

- :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>`: calculate the water vapor flux across the vertical level.

:py:func:`easyclimate.calc_horizontal_water_flux <easyclimate.calc_horizontal_water_flux>` can calculate the horizontal water flux of single layers.

.. GENERATED FROM PYTHON SOURCE LINES 328-335

.. code-block:: default


    ecl.calc_horizontal_water_flux(
        specific_humidity_data = q_data, 
        u_data = uvdata.uwnd,
        v_data = uvdata.vwnd,
    )






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (time: 2, lon: 144, lat: 73, level: 8)
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
      * level    (level) float32 1e+03 925.0 850.0 700.0 600.0 500.0 400.0 300.0
    Data variables:
        qu       (time, level, lat, lon) float32 0.3579 0.3982 ... -0.007047
        qv       (time, level, lat, lon) float32 -0.9287 -0.9122 ... 0.001194</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0deeac3e-3bd3-4aa1-b5e7-0504d7b5c49a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0deeac3e-3bd3-4aa1-b5e7-0504d7b5c49a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>level</span>: 8</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9b9eefe7-55d6-4e63-8bec-78cb9301ea53' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9b9eefe7-55d6-4e63-8bec-78cb9301ea53' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-560d43db-a66d-4cf1-8a03-2dbad047e12e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-560d43db-a66d-4cf1-8a03-2dbad047e12e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a01f12aa-8e98-4356-9feb-ff5a03756c0f' class='xr-var-data-in' type='checkbox'><label for='data-a01f12aa-8e98-4356-9feb-ff5a03756c0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-5be9fdb2-ffed-453d-a764-c9164e8ffaa6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5be9fdb2-ffed-453d-a764-c9164e8ffaa6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cfa3a17-35a6-4a93-90a8-ad2b0a365101' class='xr-var-data-in' type='checkbox'><label for='data-7cfa3a17-35a6-4a93-90a8-ad2b0a365101' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-c77ac58b-3ac8-478e-bd97-edf3669ba1eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c77ac58b-3ac8-478e-bd97-edf3669ba1eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b90fcea-c203-412b-beb3-2a414f014866' class='xr-var-data-in' type='checkbox'><label for='data-0b90fcea-c203-412b-beb3-2a414f014866' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 400.0 300.0</div><input id='attrs-b3a8f863-f9ef-4190-b97d-45f3e49fd746' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b3a8f863-f9ef-4190-b97d-45f3e49fd746' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0885d367-6577-4ebc-aa53-92ed834f54d6' class='xr-var-data-in' type='checkbox'><label for='data-0885d367-6577-4ebc-aa53-92ed834f54d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_pressure</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>units :</span></dt><dd>millibar</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.  300.]</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-61c8c96d-53c1-46e4-a1eb-09ce70df1afd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-61c8c96d-53c1-46e4-a1eb-09ce70df1afd' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.3579 0.3982 ... -0.007047</div><input id='attrs-bef61f8a-2ad4-43b7-919d-8776676e8bbb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bef61f8a-2ad4-43b7-919d-8776676e8bbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c9cab34-7c4f-474a-8d2c-f00c83325fb8' class='xr-var-data-in' type='checkbox'><label for='data-7c9cab34-7c4f-474a-8d2c-f00c83325fb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 3.57883036e-01,  3.98152560e-01,  4.38422114e-01, ...,
               2.34596267e-01,  2.76930898e-01,  3.16993952e-01],
             [ 6.72771037e-02,  1.20953225e-01,  1.75328195e-01, ...,
              -8.64081681e-02, -3.64194512e-02,  1.26979304e-02],
             [ 4.37529944e-02,  1.26659304e-01,  2.18098059e-01, ...,
              -1.39770165e-01, -8.91409293e-02, -2.89416406e-02],
             ...,
             [-1.29531682e-01, -1.49078846e-01, -1.68693021e-01, ...,
              -7.36974776e-02, -9.17841047e-02, -1.10312007e-01],
             [-1.70557305e-01, -1.75420001e-01, -1.79937020e-01, ...,
              -1.53795123e-01, -1.59868911e-01, -1.65068328e-01],
             [-2.19000965e-01, -2.25325063e-01, -2.31118590e-01, ...,
              -1.97861537e-01, -2.05247089e-01, -2.12588385e-01]],

            [[ 2.69623637e-01,  3.00784588e-01,  3.31781358e-01, ...,
               1.71712905e-01,  2.03857839e-01,  2.37314716e-01],
             [ 5.87694049e-02,  1.02082960e-01,  1.47941858e-01, ...,
              -6.27753958e-02, -2.28826758e-02,  1.66655779e-02],
             [ 1.21284816e-02,  7.87778050e-02,  1.51972592e-01, ...,
              -1.33276269e-01, -9.41526294e-02, -4.61209677e-02],
    ...
              -8.08279868e-03, -8.66123475e-03, -9.28526092e-03],
             [-2.21411902e-02, -2.19771210e-02, -2.17400584e-02, ...,
              -2.27421131e-02, -2.25342512e-02, -2.23478209e-02],
             [-3.46937589e-02, -3.42834592e-02, -3.38446163e-02, ...,
              -3.54394391e-02, -3.52539122e-02, -3.50005962e-02]],

            [[ 4.03247541e-03,  4.02526790e-03,  4.00544750e-03, ...,
               4.04148409e-03,  4.05770075e-03,  4.04508831e-03],
             [ 6.15896285e-03,  6.34491444e-03,  6.51857676e-03, ...,
               5.91550255e-03,  5.91961620e-03,  6.04589144e-03],
             [ 6.69910340e-03,  7.49462703e-03,  8.37483816e-03, ...,
               5.19840326e-03,  5.43986401e-03,  5.99670364e-03],
             ...,
             [-1.21538877e-03, -1.24731637e-03, -1.27466582e-03, ...,
              -1.13206636e-03, -1.16068567e-03, -1.18242716e-03],
             [-3.84470983e-03, -3.76838353e-03, -3.65987723e-03, ...,
              -4.09236364e-03, -4.01350297e-03, -3.94624844e-03],
             [-6.99382089e-03, -6.91809133e-03, -6.83114212e-03, ...,
              -7.12775113e-03, -7.09689967e-03, -7.04711350e-03]]]],
          dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, level, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.9287 -0.9122 ... 0.001194</div><input id='attrs-be8532d1-2797-4f74-848a-bc7a028f3816' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be8532d1-2797-4f74-848a-bc7a028f3816' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-adcf816f-2a27-49b3-aef7-35693cd828e6' class='xr-var-data-in' type='checkbox'><label for='data-adcf816f-2a27-49b3-aef7-35693cd828e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[-9.28677619e-01, -9.12156761e-01, -8.94809842e-01, ...,
              -9.67708111e-01, -9.56969738e-01, -9.43133473e-01],
             [-9.05682266e-01, -9.12177622e-01, -9.15457249e-01, ...,
              -8.71844172e-01, -8.85442317e-01, -8.97087276e-01],
             [-1.16406357e+00, -1.23160505e+00, -1.28302145e+00, ...,
              -9.03379381e-01, -9.96056259e-01, -1.08463359e+00],
             ...,
             [-1.75585821e-01, -1.76075116e-01, -1.75573900e-01, ...,
              -1.66714668e-01, -1.70317307e-01, -1.73800007e-01],
             [-1.43474877e-01, -1.36783600e-01, -1.30478472e-01, ...,
              -1.60485014e-01, -1.55592442e-01, -1.49569124e-01],
             [-1.49612337e-01, -1.39794454e-01, -1.29976541e-01, ...,
              -1.76677883e-01, -1.68230951e-01, -1.58811092e-01]],

            [[-7.31624484e-01, -7.19980180e-01, -7.05055714e-01, ...,
              -7.60817170e-01, -7.52617002e-01, -7.42776632e-01],
             [-7.17676818e-01, -7.22057879e-01, -7.23932683e-01, ...,
              -6.89850092e-01, -7.00998783e-01, -7.11117268e-01],
             [-9.35872138e-01, -9.91929948e-01, -1.03393590e+00, ...,
              -7.23102272e-01, -7.98541546e-01, -8.70113552e-01],
    ...
               4.77810623e-04,  1.04721962e-03,  1.73542392e-03],
             [ 5.91062335e-03,  6.91751717e-03,  7.89710786e-03, ...,
               2.98286392e-03,  3.95420659e-03,  4.93401149e-03],
             [ 8.17751233e-03,  9.70098283e-03,  1.11745000e-02, ...,
               3.58925620e-03,  5.12343226e-03,  6.68614730e-03]],

            [[ 2.77480227e-04,  4.50455263e-04,  6.18024555e-04, ...,
              -2.66669784e-04, -9.00913801e-05,  8.64871035e-05],
             [-2.98992149e-03, -3.02977231e-03, -3.04939901e-03, ...,
              -2.86408933e-03, -2.88517820e-03, -2.94567435e-03],
             [-3.80958477e-03, -4.45881067e-03, -5.13322232e-03, ...,
              -2.36102776e-03, -2.70353653e-03, -3.21330922e-03],
             ...,
             [ 4.35454887e-04,  5.30001416e-04,  6.31168426e-04, ...,
               1.99651506e-04,  2.70568387e-04,  3.50068934e-04],
             [ 1.03582791e-03,  1.18577783e-03,  1.31927594e-03, ...,
               5.64198184e-04,  7.26516591e-04,  8.87191389e-04],
             [ 1.50268292e-03,  1.81051216e-03,  2.10782280e-03, ...,
               5.73586614e-04,  8.84920824e-04,  1.19415275e-03]]]],
          dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-46cd7ec3-d5a0-49dd-81a3-a4b5f972bfca' class='xr-section-summary-in' type='checkbox'  ><label for='section-46cd7ec3-d5a0-49dd-81a3-a4b5f972bfca' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-693c3047-46e5-480c-bab6-f039e7d44c80' class='xr-index-data-in' type='checkbox'/><label for='index-693c3047-46e5-480c-bab6-f039e7d44c80' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a1956ea4-2a10-4ce7-b81b-17eff4a1ba48' class='xr-index-data-in' type='checkbox'/><label for='index-a1956ea4-2a10-4ce7-b81b-17eff4a1ba48' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-709e8683-b6a7-47ca-8104-590dda6277de' class='xr-index-data-in' type='checkbox'/><label for='index-709e8683-b6a7-47ca-8104-590dda6277de' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-64b61280-f3f9-495a-98f4-5cd5a79b7a0a' class='xr-index-data-in' type='checkbox'/><label for='index-64b61280-f3f9-495a-98f4-5cd5a79b7a0a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([1000.0, 925.0, 850.0, 700.0, 600.0, 500.0, 400.0, 300.0], dtype=&#x27;float64&#x27;, name=&#x27;level&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-18aa5e7b-dbe3-4300-89a6-c60af69894e5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-18aa5e7b-dbe3-4300-89a6-c60af69894e5' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 336-337

The whole layer integral needs to consider the function :py:func:`easyclimate.calc_water_flux_top2surface_integral <easyclimate.calc_water_flux_top2surface_integral>` to calculate.

.. GENERATED FROM PYTHON SOURCE LINES 337-349

.. code-block:: default


    water_flux_top2surface_integral = ecl.calc_water_flux_top2surface_integral(
        specific_humidity_data = q_data, 
        u_data = u_data, 
        v_data = v_data,
        surface_pressure_data = msl_data, 
        surface_pressure_data_units = 'millibars',
        vertical_dim = 'level', 
        vertical_dim_units = 'hPa',
    )
    water_flux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (time: 2, lon: 144, lat: 73)
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
    Data variables:
        qu       (time, lat, lon) float32 764.1 420.4 ... -2.405e+04 -2.415e+04
        qv       (time, lat, lon) float32 7.884e+03 7.905e+03 ... -1.976e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b65057ae-91e5-40e8-9a35-3f666917d1dc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b65057ae-91e5-40e8-9a35-3f666917d1dc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lon</span>: 144</li><li><span class='xr-has-index'>lat</span>: 73</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-98baae14-897c-4e05-ad35-237c4a53849c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-98baae14-897c-4e05-ad35-237c4a53849c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-6e8b6db5-c8b1-4b70-a6f7-490d30a15820' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e8b6db5-c8b1-4b70-a6f7-490d30a15820' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f009058-74ce-4dc5-b64d-2a8f95c005ba' class='xr-var-data-in' type='checkbox'><label for='data-6f009058-74ce-4dc5-b64d-2a8f95c005ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-5a3fc6d7-bf01-4f9b-bb4d-392acdcaa6ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a3fc6d7-bf01-4f9b-bb4d-392acdcaa6ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8fbb40c3-b66a-4321-8afd-d582acb2f9e9' class='xr-var-data-in' type='checkbox'><label for='data-8fbb40c3-b66a-4321-8afd-d582acb2f9e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-552f11ef-5dd5-46cd-940d-bd515c3c7edd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-552f11ef-5dd5-46cd-940d-bd515c3c7edd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77fb5c26-9909-40c5-b076-7da457498b56' class='xr-var-data-in' type='checkbox'><label for='data-77fb5c26-9909-40c5-b076-7da457498b56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e3f16fea-2248-455b-9ec7-cc3e8d6818e4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e3f16fea-2248-455b-9ec7-cc3e8d6818e4' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>qu</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>764.1 420.4 ... -2.415e+04</div><input id='attrs-c7261b62-ade6-44c9-95d1-2bacee13ff14' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c7261b62-ade6-44c9-95d1-2bacee13ff14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f60e40e7-271b-42f1-a3d4-65d42f87e0f9' class='xr-var-data-in' type='checkbox'><label for='data-f60e40e7-271b-42f1-a3d4-65d42f87e0f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[   764.1305 ,    420.386  ,     41.37965, ...,   1754.9336 ,
               1408.9583 ,   1111.3759 ],
            [  2888.3228 ,   2628.0552 ,   2389.276  , ...,   3665.8916 ,
               3424.9082 ,   3215.754  ],
            [   947.62415,    694.2946 ,    401.24915, ...,   1777.574  ,
               1493.9509 ,   1255.2438 ],
            ...,
            [-10500.327  , -11242.958  , -11988.612  , ...,  -8289.951  ,
              -9007.941  ,  -9734.624  ],
            [-12183.795  , -12402.442  , -12612.091  , ..., -11504.028  ,
             -11724.952  , -11951.933  ],
            [-15247.002  , -15466.363  , -15664.332  , ..., -14401.904  ,
             -14706.968  , -14991.695  ]],

           [[  2536.8816 ,   2174.4268 ,   1812.0328 , ...,   3582.4114 ,
               3247.1133 ,   2892.419  ],
            [  3421.082  ,   3258.8306 ,   3107.3137 , ...,   3943.8455 ,
               3758.8271 ,   3592.8806 ],
            [  3346.2932 ,   3641.9219 ,   3921.0427 , ...,   2589.7036 ,
               2772.7332 ,   3036.336  ],
            ...,
            [ -8941.726  ,  -9802.936  , -10667.026  , ...,  -6543.59   ,
              -7298.8247 ,  -8107.329  ],
            [-17655.908  , -17937.752  , -18217.6    , ..., -16691.25   ,
             -17021.02   , -17340.396  ],
            [-24214.209  , -24232.627  , -24206.156  , ..., -23887.533  ,
             -24046.729  , -24154.074  ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>7.884e+03 7.905e+03 ... -1.976e+03</div><input id='attrs-703a1703-cf0c-43d0-92c4-afec370bdefe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-703a1703-cf0c-43d0-92c4-afec370bdefe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df043b16-ad9b-4cdc-94b1-64a446ee150e' class='xr-var-data-in' type='checkbox'><label for='data-df043b16-ad9b-4cdc-94b1-64a446ee150e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div><div class='xr-var-data'><pre>array([[[ 7883.659  ,  7905.0005 ,  7958.5405 , ...,  7734.329  ,
              7816.0127 ,  7834.132  ],
            [ 5235.9478 ,  5501.0444 ,  5734.6694 , ...,  4427.38   ,
              4702.162  ,  4980.545  ],
            [ 7450.4116 ,  7791.355  ,  8025.6284 , ...,  5602.8    ,
              6343.4473 ,  6962.0586 ],
            ...,
            [-7246.3057 , -7228.243  , -7149.3955 , ..., -6951.0054 ,
             -7099.7163 , -7201.847  ],
            [-4956.352  , -4603.5    , -4242.636  , ..., -5917.206  ,
             -5606.452  , -5287.6064 ],
            [-5470.336  , -4798.7974 , -4126.2026 , ..., -7418.8403 ,
             -6780.4375 , -6127.9463 ]],

           [[ 8228.076  ,  8342.619  ,  8418.245  , ...,  7842.9697 ,
              7988.952  ,  8124.053  ],
            [ 3624.8127 ,  3730.7979 ,  3883.9333 , ...,  3271.8242 ,
              3390.2607 ,  3505.3909 ],
            [ 2831.7595 ,  3149.7505 ,  3397.659  , ...,  1891.5964 ,
              2185.9998 ,  2494.4062 ],
            ...,
            [-5310.676  , -4914.6494 , -4417.6567 , ..., -5789.008  ,
             -5735.0073 , -5571.867  ],
            [-2336.2898 , -1571.1039 ,  -777.90063, ..., -4423.016  ,
             -3761.101  , -3064.675  ],
            [ -919.7678 ,   132.96321,  1190.7288 , ..., -4073.0735 ,
             -3036.5168 , -1975.7177 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8113dee8-47d8-4096-b57d-7818256e0d47' class='xr-section-summary-in' type='checkbox'  ><label for='section-8113dee8-47d8-4096-b57d-7818256e0d47' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-919ee0e6-cc48-46bb-b3c7-f1058711ffd4' class='xr-index-data-in' type='checkbox'/><label for='index-919ee0e6-cc48-46bb-b3c7-f1058711ffd4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c736a820-586f-4e97-843c-a26186aaeb7f' class='xr-index-data-in' type='checkbox'/><label for='index-c736a820-586f-4e97-843c-a26186aaeb7f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a366e68a-77ad-48ad-93db-bfd356e1d910' class='xr-index-data-in' type='checkbox'/><label for='index-a366e68a-77ad-48ad-93db-bfd356e1d910' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-67f82af9-ab16-4d4d-9d78-d1186346775b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-67f82af9-ab16-4d4d-9d78-d1186346775b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 350-377

.. code-block:: default


    draw_water_flux = water_flux_top2surface_integral.isel(time = 0).thin(lon = 3, lat = 3).sel(lat = slice(-60, 60))
    draw_pr = pr_data.isel(time = 0).sel(lat = slice(-60, 60))

    # ---------------------------------
    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    draw_water_flux.plot.quiver(
        ax = ax,
        u = 'qu', v = 'qv', x = 'lon', y = 'lat',
        transform = ccrs.PlateCarree(),
        zorder = 2,
    );

    draw_pr.plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        levels = 21,
        cmap = 'Greens',
        zorder = 1,
        cbar_kwargs = {'location': 'bottom'},
        vmax = 20,
    );




.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_015.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_015.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x000002361111EE00>



.. GENERATED FROM PYTHON SOURCE LINES 378-389

Water vapor flux divergence
--------------------------------------

Water vapor flux divergence represents the convergence and divergence of water vapor. There are also two built-in functions to calculate the results of single-layers and whole-layer integration respectively.

- :py:func:`easyclimate.calc_divergence_watervaporflux <easyclimate.calc_divergence_watervaporflux>`: calculate water vapor flux divergence at each vertical level.

.. math::
  \nabla \left( \frac{1}{g} q \mathbf{V} \right) = \frac{1}{g} \nabla \cdot \left( q \mathbf{V} \right)

- :py:func:`easyclimate.calc_divergence_watervaporflux_top2surface_integral <easyclimate.calc_divergence_watervaporflux_top2surface_integral>`: calculate water vapor flux divergence across the vertical level.

.. GENERATED FROM PYTHON SOURCE LINES 389-402

.. code-block:: default


    divergence_watervaporflux_top2surface_integral = ecl.calc_divergence_watervaporflux_top2surface_integral(
        specific_humidity_data = q_data,
        u_data = u_data,
        v_data = v_data,
        surface_pressure_data = msl_data,
        surface_pressure_data_units = 'millibars',
        specific_humidity_units = 'grams/kg',
        vertical_dim = 'level',
        vertical_dim_units = 'hPa',
    )
    divergence_watervaporflux_top2surface_integral






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 2, lat: 73, lon: 144)&gt;
    array([[[-1.47138916e-03,  1.35440704e-03,  2.12104024e-04, ...,
              7.63451213e-04, -1.58517398e-03, -5.63335615e-03],
            [-8.78047936e-10,  2.77973368e-09,  9.07116751e-10, ...,
             -5.38412165e-09, -1.66413833e-09,  3.44718846e-09],
            [ 1.05444328e-08,  9.55497729e-09,  1.08459571e-08, ...,
              3.05369584e-09,  6.10039023e-09,  1.00502167e-08],
            ...,
            [-8.28521914e-09, -7.65947810e-09, -7.18742773e-09, ...,
             -1.11239579e-08, -1.00659209e-08, -8.98731767e-09],
            [ 1.89051734e-09,  2.56174589e-09,  1.98235108e-09, ...,
              1.06464441e-09,  1.55097810e-09,  1.23327180e-09],
            [-7.10215410e-04, -5.94130008e-05,  5.79028246e-05, ...,
              9.31174891e-05, -7.87465841e-05,  5.90777114e-04]],

           [[ 2.85382646e-04, -1.30979441e-04,  6.43686898e-04, ...,
             -5.03265810e-04, -2.95329631e-04,  8.16090931e-04],
            [-1.06686347e-08, -8.79369365e-09, -8.82426665e-09, ...,
             -1.54865663e-08, -1.35132826e-08, -1.08642684e-08],
            [ 1.98332477e-08,  1.98366959e-08,  1.80170149e-08, ...,
              9.48953545e-09,  1.35660861e-08,  1.84950117e-08],
            ...,
            [-1.62302742e-08, -1.57168156e-08, -1.57410230e-08, ...,
             -1.56846938e-08, -1.57971339e-08, -1.63707830e-08],
            [-8.02328376e-09, -9.43031007e-09, -9.74286703e-09, ...,
             -1.01034135e-08, -9.31232781e-09, -9.39057441e-09],
            [ 5.98618235e-05,  1.46056969e-04,  9.44555694e-05, ...,
              1.38477774e-04,  6.39792612e-05, -3.94048290e-04]]])
    Coordinates:
      * time     (time) datetime64[ns] 2022-01-01 2022-02-01
      * lon      (lon) float32 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
      * lat      (lat) float32 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
    Attributes:
        Vertical integral method:  Trenberth-vibeta</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2</li><li><span class='xr-has-index'>lat</span>: 73</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2fda1c96-cb56-4d8d-a749-2ae2d590a37b' class='xr-array-in' type='checkbox' checked><label for='section-2fda1c96-cb56-4d8d-a749-2ae2d590a37b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.001471 0.001354 0.0002121 ... 0.0001385 6.398e-05 -0.000394</span></div><div class='xr-array-data'><pre>array([[[-1.47138916e-03,  1.35440704e-03,  2.12104024e-04, ...,
              7.63451213e-04, -1.58517398e-03, -5.63335615e-03],
            [-8.78047936e-10,  2.77973368e-09,  9.07116751e-10, ...,
             -5.38412165e-09, -1.66413833e-09,  3.44718846e-09],
            [ 1.05444328e-08,  9.55497729e-09,  1.08459571e-08, ...,
              3.05369584e-09,  6.10039023e-09,  1.00502167e-08],
            ...,
            [-8.28521914e-09, -7.65947810e-09, -7.18742773e-09, ...,
             -1.11239579e-08, -1.00659209e-08, -8.98731767e-09],
            [ 1.89051734e-09,  2.56174589e-09,  1.98235108e-09, ...,
              1.06464441e-09,  1.55097810e-09,  1.23327180e-09],
            [-7.10215410e-04, -5.94130008e-05,  5.79028246e-05, ...,
              9.31174891e-05, -7.87465841e-05,  5.90777114e-04]],

           [[ 2.85382646e-04, -1.30979441e-04,  6.43686898e-04, ...,
             -5.03265810e-04, -2.95329631e-04,  8.16090931e-04],
            [-1.06686347e-08, -8.79369365e-09, -8.82426665e-09, ...,
             -1.54865663e-08, -1.35132826e-08, -1.08642684e-08],
            [ 1.98332477e-08,  1.98366959e-08,  1.80170149e-08, ...,
              9.48953545e-09,  1.35660861e-08,  1.84950117e-08],
            ...,
            [-1.62302742e-08, -1.57168156e-08, -1.57410230e-08, ...,
             -1.56846938e-08, -1.57971339e-08, -1.63707830e-08],
            [-8.02328376e-09, -9.43031007e-09, -9.74286703e-09, ...,
             -1.01034135e-08, -9.31232781e-09, -9.39057441e-09],
            [ 5.98618235e-05,  1.46056969e-04,  9.44555694e-05, ...,
              1.38477774e-04,  6.39792612e-05, -3.94048290e-04]]])</pre></div></div></li><li class='xr-section-item'><input id='section-5c6071ba-565a-4ed1-bc65-6125e1f8333b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c6071ba-565a-4ed1-bc65-6125e1f8333b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-01-01 2022-02-01</div><input id='attrs-4be37caa-f869-49fd-aed5-6a8924c5cdd0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4be37caa-f869-49fd-aed5-6a8924c5cdd0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-148adcfb-7a42-423e-bfc0-a24797efed6b' class='xr-var-data-in' type='checkbox'><label for='data-148adcfb-7a42-423e-bfc0-a24797efed6b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-01-01T00:00:00.000000000&#x27;, &#x27;2022-02-01T00:00:00.000000000&#x27;],
          dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-1f4af7cf-2ac4-4edc-a633-8ce0ee2e005c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1f4af7cf-2ac4-4edc-a633-8ce0ee2e005c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f02743dd-e816-4ba9-95a5-dde080a3cc58' class='xr-var-data-in' type='checkbox'><label for='data-f02743dd-e816-4ba9-95a5-dde080a3cc58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,
            25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,
            50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,
            75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,
           100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,
           125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,
           150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,
           175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,
           200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,
           350. , 352.5, 355. , 357.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -87.5 -85.0 ... 87.5 90.0</div><input id='attrs-487fffb8-568f-4b84-b01a-354bc1d29d48' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-487fffb8-568f-4b84-b01a-354bc1d29d48' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c305e869-1619-4dee-b373-16ecfb63adee' class='xr-var-data-in' type='checkbox'><label for='data-c305e869-1619-4dee-b373-16ecfb63adee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -87.5, -85. , -82.5, -80. , -77.5, -75. , -72.5, -70. , -67.5,
           -65. , -62.5, -60. , -57.5, -55. , -52.5, -50. , -47.5, -45. , -42.5,
           -40. , -37.5, -35. , -32.5, -30. , -27.5, -25. , -22.5, -20. , -17.5,
           -15. , -12.5, -10. ,  -7.5,  -5. ,  -2.5,   0. ,   2.5,   5. ,   7.5,
            10. ,  12.5,  15. ,  17.5,  20. ,  22.5,  25. ,  27.5,  30. ,  32.5,
            35. ,  37.5,  40. ,  42.5,  45. ,  47.5,  50. ,  52.5,  55. ,  57.5,
            60. ,  62.5,  65. ,  67.5,  70. ,  72.5,  75. ,  77.5,  80. ,  82.5,
            85. ,  87.5,  90. ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e30fb937-388c-46ed-bc65-99f26e76caf9' class='xr-section-summary-in' type='checkbox'  ><label for='section-e30fb937-388c-46ed-bc65-99f26e76caf9' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a71680f6-9640-4138-841f-506eb1171cf9' class='xr-index-data-in' type='checkbox'/><label for='index-a71680f6-9640-4138-841f-506eb1171cf9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-01-01&#x27;, &#x27;2022-02-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8f706cb2-29c4-46bc-8f9d-885226f6e5e8' class='xr-index-data-in' type='checkbox'/><label for='index-8f706cb2-29c4-46bc-8f9d-885226f6e5e8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,
                  ...
                  335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0,
                  357.5],
                 dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2c1b465f-bd03-4251-bd85-817394ec2b8e' class='xr-index-data-in' type='checkbox'/><label for='index-2c1b465f-bd03-4251-bd85-817394ec2b8e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-90.0, -87.5, -85.0, -82.5, -80.0, -77.5, -75.0, -72.5, -70.0,
                  -67.5, -65.0, -62.5, -60.0, -57.5, -55.0, -52.5, -50.0, -47.5,
                  -45.0, -42.5, -40.0, -37.5, -35.0, -32.5, -30.0, -27.5, -25.0,
                  -22.5, -20.0, -17.5, -15.0, -12.5, -10.0,  -7.5,  -5.0,  -2.5,
                    0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,
                   22.5,  25.0,  27.5,  30.0,  32.5,  35.0,  37.5,  40.0,  42.5,
                   45.0,  47.5,  50.0,  52.5,  55.0,  57.5,  60.0,  62.5,  65.0,
                   67.5,  70.0,  72.5,  75.0,  77.5,  80.0,  82.5,  85.0,  87.5,
                   90.0],
                 dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-274dd751-95ee-4c08-8329-19b7dccf9ba1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-274dd751-95ee-4c08-8329-19b7dccf9ba1' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Vertical integral method :</span></dt><dd>Trenberth-vibeta</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 403-417

.. code-block:: default


    draw_data = divergence_watervaporflux_top2surface_integral.isel(time = 0).sel(lat = slice(-60, 60))

    # ---------------------------------
    fig, ax = plt.subplots(subplot_kw = {'projection': ccrs.PlateCarree(central_longitude = 180)})

    ax.gridlines(draw_labels = ['bottom', 'left'], color = "grey", alpha = 0.5, linestyle="--")
    ax.coastlines(edgecolor = 'black', linewidths = 0.5)

    draw_data.plot.contourf(
        ax = ax,
        transform = ccrs.PlateCarree(),
        cbar_kwargs = {'location': 'bottom'},
        levels = 21,
    )


.. image-sg:: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_016.png
   :alt: time = 2022-01-01
   :srcset: /auto_gallery/images/sphx_glr_plot_1_geographic_finite_difference_016.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <cartopy.mpl.contour.GeoContourSet object at 0x0000023611BDBE50>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  12.877 seconds)


.. _sphx_glr_download_auto_gallery_plot_1_geographic_finite_difference.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_1_geographic_finite_difference.py <plot_1_geographic_finite_difference.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_1_geographic_finite_difference.ipynb <plot_1_geographic_finite_difference.ipynb>`
